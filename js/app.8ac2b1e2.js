(function(e){function t(t){for(var a,i,r=t[0],l=t[1],c=t[2],f=0,d=[];f<r.length;f++)i=r[f],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&d.push(o[i][0]),o[i]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);u&&u(t);while(d.length)d.shift()();return s.push.apply(s,c||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],a=!0,r=1;r<n.length;r++){var l=n[r];0!==o[l]&&(a=!1)}a&&(s.splice(t--,1),e=i(i.s=n[0]))}return e}var a={},o={app:0},s=[];function i(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=a,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/picx/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=t,r=r.slice();for(var c=0;c<r.length;c++)t(r[c]);var u=l;s.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"086a":function(e,t,n){},"0897":function(e,t,n){"use strict";var a=n("1235"),o=n.n(a);o.a},1235:function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"layout-container"}},[n("div",{staticClass:"app-container"},[n("div",{staticClass:"app-header-container"},[n("div",{staticClass:"header-content"},[n("Header")],1)]),n("div",{staticClass:"app-main-container"},[n("div",{staticClass:"main-content"},[n("router-view")],1)])])])},s=[],i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("header",{staticClass:"header"},[n("div",{staticClass:"logo",on:{click:function(t){return e.$router.push("/")}}},[n("i",{staticClass:"el-icon-picture-outline logo-icon"}),e._v(" PicX ")]),n("div",{staticClass:"user-info"},[n("span",{staticClass:"username"},[e._v(e._s(e.username))]),n("el-dropdown",{attrs:{trigger:"click"},on:{command:e.handleCommand}},[n("span",{staticClass:"el-dropdown-link"},[n("span",{staticClass:"avatar"},[n("img",{attrs:{src:e.avatarUrl}})])]),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{command:"upload"}},[e._v("图片上传")]),n("el-dropdown-item",{attrs:{command:"config"}},[e._v("图床配置")]),e.userConfigInfo.loggingStatus?n("el-dropdown-item",{attrs:{command:"logout"}},[e._v("退出登录 ")]):e._e()],1)],1)],1)])},r=[],l=(n("b0c0"),n("5530")),c="PICX_INFO",u=n("2f62"),f={name:"Header",data:function(){return{userConfigInfo:{},username:"",defaultUsername:"未登录",avatarUrl:"",defaultAvatarUrl:"https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png"}},watch:{getUserAvatar:function(e){this.avatarUrl=e||this.defaultAvatarUrl},getUserName:function(e){this.username=e||this.defaultUsername},getUserLoggingStatus:function(e){this.userConfigInfo.loggingStatus=e}},computed:Object(l["a"])({},Object(u["b"])(["getUserAvatar","getUserName","getUserLoggingStatus"])),mounted:function(){this.getUserInfo()},methods:{handleCommand:function(e){switch(e){case"upload":this.$router.push("/");break;case"config":this.$router.push("config");break;case"management":this.$router.push("management");break;case"logout":this.logout();break}},getUserInfo:function(){var e=localStorage.getItem(c);e?(this.userConfigInfo=JSON.parse(e),this.username=this.userConfigInfo.name?this.userConfigInfo.name:this.defaultUsername,this.avatarUrl=this.userConfigInfo.avatar_url?this.userConfigInfo.avatar_url:this.defaultAvatarUrl):(this.username=this.defaultUsername,this.avatarUrl=this.defaultAvatarUrl)},logout:function(){this.$store.dispatch("LOGOUT")}}},d=f,p=(n("0897"),n("2877")),g=Object(p["a"])(d,i,r,!1,null,"48617fb2",null),h=g.exports,m={components:{Header:h}},v=m,C=(n("5c0b"),Object(p["a"])(v,o,s,!1,null,null,null)),I=C.exports,b=n("8c4f"),_=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"config-page-container"},[n("el-form",{staticClass:"config-form",attrs:{"label-width":"70px","label-position":"right"}},[n("el-form-item",{attrs:{label:"Token"}},[n("el-input",{model:{value:e.token,callback:function(t){e.token=t},expression:"token"}})],1),n("el-form-item",{staticClass:"operation-btns"},[n("el-button",{on:{click:function(t){return e.reset()}}},[e._v(" 重置 ")]),n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.getUserInfo()}}},[e._v(" 确认Token ")])],1),e.userConfigInfo.owner?n("el-form-item",{attrs:{label:"用户名"}},[n("el-input",{attrs:{readonly:""},model:{value:e.userConfigInfo.owner,callback:function(t){e.$set(e.userConfigInfo,"owner",t)},expression:"userConfigInfo.owner"}})],1):e._e(),e.userConfigInfo.email?n("el-form-item",{attrs:{label:"邮箱"}},[n("el-input",{attrs:{readonly:""},model:{value:e.userConfigInfo.email,callback:function(t){e.$set(e.userConfigInfo,"email",t)},expression:"userConfigInfo.email"}})],1):e._e(),e.userConfigInfo.reposList.length?n("el-form-item",{attrs:{label:"选择仓库"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:"请选择图床仓库..."},on:{change:e.selectRepos},model:{value:e.userConfigInfo.selectedRepos,callback:function(t){e.$set(e.userConfigInfo,"selectedRepos",t)},expression:"userConfigInfo.selectedRepos"}},e._l(e.userConfigInfo.reposList,(function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),e.userConfigInfo.reposList.length&&e.userConfigInfo.selectedRepos?n("el-form-item",{attrs:{label:"目录方式"}},[n("el-radio-group",{on:{change:e.dirModeChange},model:{value:e.userConfigInfo.dirMode,callback:function(t){e.$set(e.userConfigInfo,"dirMode",t)},expression:"userConfigInfo.dirMode"}},[n("el-tooltip",{attrs:{content:"根据日期自动创建格式 YYYYMMDD 的目录",placement:"top"}},[n("el-radio",{attrs:{label:"autoDir"}},[e._v("自动目录")])],1),n("el-tooltip",{attrs:{content:"手动输入一个新目录",placement:"top"}},[n("el-radio",{attrs:{label:"newDir"}},[e._v("新建目录")])],1),e.userConfigInfo.dirList.length?n("el-tooltip",{attrs:{content:"选择 "+e.userConfigInfo.selectedRepos+" 仓库下的一个目录",placement:"top"}},[n("el-radio",{attrs:{label:"reposDir"}},[e._v("选择"+e._s(e.userConfigInfo.selectedRepos)+"仓库目录")])],1):e._e()],1)],1):e._e(),"autoDir"===e.userConfigInfo.dirMode?n("el-form-item",{attrs:{label:"自动目录"}},[n("el-input",{attrs:{readonly:""},model:{value:e.userConfigInfo.selectedDir,callback:function(t){e.$set(e.userConfigInfo,"selectedDir",t)},expression:"userConfigInfo.selectedDir"}})],1):e._e(),"newDir"===e.userConfigInfo.dirMode?n("el-form-item",{attrs:{label:"新建目录"}},[n("el-input",{attrs:{clearable:"",placeholder:"请输入新建的目录..."},on:{input:function(t){return e.persistUserConfigInfo()}},model:{value:e.userConfigInfo.selectedDir,callback:function(t){e.$set(e.userConfigInfo,"selectedDir",t)},expression:"userConfigInfo.selectedDir"}})],1):e._e(),e.userConfigInfo.dirList.length&&"reposDir"===e.userConfigInfo.dirMode?n("el-form-item",{attrs:{label:"选择目录"}},[n("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",placeholder:"请选择目录...",clearable:!0},on:{change:e.persistUserConfigInfo},model:{value:e.userConfigInfo.selectedDir,callback:function(t){e.$set(e.userConfigInfo,"selectedDir",t)},expression:"userConfigInfo.selectedDir"}},e._l(e.userConfigInfo.dirList,(function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),e.userConfigInfo.selectedRepos?n("el-form-item",{staticStyle:{float:"right"}},[n("el-button",{attrs:{type:"success"},on:{click:e.goUpload}},[e._v("上传图片 Go~")])],1):e._e()],1)],1)},w=[],S=(n("a4d3"),n("e01a"),n("99af"),n("b85c")),x=n("bc3a"),k=n.n(x),U={token:"",owner:"",email:"",name:"",avatar_url:"",selectedRepos:"",reposList:[],dirMode:"",selectedDir:"",dirList:[],loggingStatus:!1},y=(n("d3b7"),n("ac1f"),n("25f0"),n("1276"),function(e){var t=Object.prototype.toString.call(e).split(" ")[1];return t.substring(0,t.length-1).toLowerCase()}),R=y,D=function(e){for(var t in e)switch(R(e[t])){case"string":e[t]="";break;case"array":e[t]=[];break;case"number":e[t]=0;break;case"boolean":e[t]=!1;break}},L=D,O={now:new Date,getYYYYMMDD:function(){var e=this.now.getFullYear(),t=this.now.getMonth()+1,n=this.now.getDate();return"".concat(e).concat(t<10?"0"+t:t).concat(n<10?"0"+n:n)}},$=O,N={name:"Config",data:function(){return{token:"",userConfigInfo:U}},mounted:function(){this.initUserConfigInfo()},watch:{loggingStatus:function(e){e||this.resetUserConfigInfo()}},computed:Object(l["a"])({},Object(u["b"])({loggingStatus:"getUserLoggingStatus"})),methods:{initUserConfigInfo:function(){var e=localStorage.getItem(c);if(e)for(var t in e=JSON.parse(e),this.token=e.token,e)this.userConfigInfo[t]=e[t]},getUserInfo:function(){var e=this;this.token?this.$axios.get("/user",{headers:{"Content-Type":"application/json",Authorization:"token ".concat(this.token)}}).then((function(t){200===t.status&&(e.saveUserInfo(t),e.getReposList(t.data["repos_url"]))})):this.$message.warning("Token 不能为空！")},saveUserInfo:function(e){this.userConfigInfo.loggingStatus=!0,this.userConfigInfo.token=this.token,this.userConfigInfo.owner=e.data["login"],this.userConfigInfo.name=e.data["name"],this.userConfigInfo.email=e.data["email"],this.userConfigInfo.avatar_url=e.data["avatar_url"],this.persistUserConfigInfo()},getReposList:function(e){var t=this;k.a.get(e).then((function(e){if(200===e.status){t.userConfigInfo.reposList=[];var n,a=Object(S["a"])(e.data);try{for(a.s();!(n=a.n()).done;){var o=n.value;o.fork||t.userConfigInfo.reposList.push({value:o.name,label:o.name,desc:o.description})}}catch(s){a.e(s)}finally{a.f()}t.persistUserConfigInfo()}})).catch((function(e){console.log("err",e)}))},selectRepos:function(e){this.persistUserConfigInfo(),this.getDirList(e)},getDirList:function(e){var t=this;k.a.get("https://api.github.com/repos/".concat(this.userConfigInfo.owner,"/").concat(e,"/contents")).then((function(e){if(200===e.status){t.userConfigInfo.dirList=[];var n,a=Object(S["a"])(e.data);try{for(a.s();!(n=a.n()).done;){var o=n.value;"dir"===o.type&&t.userConfigInfo.dirList.push({value:o.name,label:o.name})}}catch(s){a.e(s)}finally{a.f()}t.persistUserConfigInfo()}})).catch((function(e){console.log("err",e)}))},dirModeChange:function(e){switch(e){case"autoDir":this.userConfigInfo.selectedDir=$.getYYYYMMDD();break;case"newDir":this.userConfigInfo.selectedDir="";break;case"reposDir":break}this.persistUserConfigInfo()},persistUserConfigInfo:function(){this.$store.commit("SET_USER_CONFIG_INFO",this.userConfigInfo),this.$store.commit("PERSIST_USER_CONFIG_INFO")},reset:function(){this.resetUserConfigInfo(),this.persistUserConfigInfo()},resetUserConfigInfo:function(){this.token="",L(this.userConfigInfo)},goUpload:function(){""===this.userConfigInfo.selectedDir?"autoDir"===this.userConfigInfo.dirMode?this.$message.warning("请选择 ".concat(this.userConfigInfo.selectedRepos," 仓库下的一个目录！")):"newDir"===this.userConfigInfo.dirMode?this.$message.warning("请在输入框输入一个新目录！"):this.$router.push("/"):this.$router.push("/")}}},M=N,j=(n("abad"),Object(p["a"])(M,_,w,!1,null,"973fb414",null)),z=j.exports,E=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"upload-page-container"},[e.uploadedList.length?n("div",{staticClass:"upload-page-left",style:{width:"30%"}},[n("UploadedList",{attrs:{uploadedList:e.uploadedList}})],1):e._e(),n("div",{staticClass:"upload-page-right",style:{width:e.uploadedList.length?"70%":"100%"}},[n("el-row",{staticClass:"row-item"},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.uploadStatus.uploading&&100!==e.uploadStatus.progress,expression:"uploadStatus.uploading && uploadStatus.progress !== 100"}],staticClass:"upload-area",attrs:{"element-loading-text":"上传中...","element-loading-background":"rgba(0, 0, 0, 0.5)"},on:{dragover:function(e){e.preventDefault()},drop:function(t){return t.stopPropagation(),t.preventDefault(),e.onDrop(t)},paste:e.onPaste}},[n("label",{attrs:{for:"uploader"}}),n("input",{attrs:{id:"uploader",type:"file"},on:{change:e.onFileChange}}),e.imgData.base64Url?e._e():n("div",{staticClass:"tips"},[n("i",{staticClass:"icon el-icon-upload"}),n("div",{staticClass:"text"},[e._v("拖拽、粘贴、或点击此处上传")])]),e.imgData.base64Url?n("img",{attrs:{src:e.imgData.base64Url}}):e._e()])]),e.imgData.base64Url?n("el-row",{staticClass:"row-item"},[n("div",{staticClass:"upload-status"},[n("div",{staticClass:"file-status"},[n("div",{staticClass:"filename"},[e._v(e._s(e.filename.now)+" ")]),e.uploadStatus.uploading||100===e.uploadStatus.progress?e._e():n("div",{staticClass:"upload-tips wait-upload"},[e._v(" 等待上传 "),n("i",{staticClass:"el-icon-upload2"})]),e.uploadStatus.uploading&&100!==e.uploadStatus.progress?n("div",{staticClass:"upload-tips uploading"},[e._v(" 正在上传 "),n("i",{staticClass:"el-icon-loading"})]):e._e(),e.uploadStatus.uploading||100!==e.uploadStatus.progress?e._e():n("div",{staticClass:"upload-tips uploaded"},[e._v(" 上传完成 "),n("i",{staticClass:"el-icon-circle-check"})])])])]):e._e(),100===e.uploadStatus.progress?n("el-row",{staticClass:"row-item"},[n("div",{staticClass:"external-link"},[n("el-input",{ref:"GitHubExternalLinkInput",staticClass:"external-link-input",attrs:{placeholder:"复制GitHub外链...",size:"mini",readonly:""},model:{value:e.externalLink.github,callback:function(t){e.$set(e.externalLink,"github",t)},expression:"externalLink.github"}},[n("template",{slot:"prepend"},[e._v("GitHub外链")]),n("el-button",{attrs:{slot:"append",icon:"el-icon-copy-document"},on:{click:function(t){return e.copyLink("GitHub")}},slot:"append"},[e._v("复制 ")])],2),n("el-input",{ref:"CDNExternalLinkInput",staticClass:"external-link-input",attrs:{placeholder:"复制CDN外链...",size:"mini",readonly:""},model:{value:e.externalLink.cdn,callback:function(t){e.$set(e.externalLink,"cdn",t)},expression:"externalLink.cdn"}},[n("template",{slot:"prepend"},[e._v("CDN外链")]),n("el-button",{attrs:{slot:"append",icon:"el-icon-copy-document"},on:{click:function(t){return e.copyLink("CDN")}},slot:"append"},[e._v("复制 ")])],2)],1)]):e._e(),n("el-row",{staticClass:"row-item"},[n("div",{staticClass:"upload-tools"},[e.userConfigInfo.selectedRepos?n("div",{staticClass:"repos-dir-info"},[n("el-tag",{staticClass:"repos-dir-info-item"},[e._v("仓库："+e._s(e.userConfigInfo.selectedRepos))]),n("el-tag",{staticClass:"repos-dir-info-item"},[e._v("目录："+e._s(e.userConfigInfo.selectedDir))])],1):e._e(),n("UploadTools",{attrs:{"is-show-rename":""!==e.imgData.base64Url&&100!==e.uploadStatus.progress},on:{"is-set-max-size":e.onSetMaxSizeChane,"max-size":e.onMaxSizeChange,rename:e.rename,"hash-named":e.hashRename,"upload-reset":e.resetUploadInfo,"upload-file":e.uploadImage}})],1)])],1)])},H=[],T=(n("b64b"),n("96cf"),n("1da1")),P=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.isShowRename?n("div",{staticClass:"tool-item"},[n("el-switch",{attrs:{"inactive-text":"重命名"},on:{change:function(t){return e.rename()}},model:{value:e.isRename,callback:function(t){e.isRename=t},expression:"isRename"}})],1):e._e(),e.isShowRename&&e.isRename?n("div",{staticClass:"tool-item"},[n("el-input",{attrs:{placeholder:"请输入新的名字",size:"small",clearable:!0},on:{input:function(t){return e.rename()}},model:{value:e.newName,callback:function(t){e.newName=t},expression:"newName"}})],1):e._e(),n("div",{staticClass:"tool-item"},[n("el-switch",{attrs:{"inactive-text":"哈希命名"},on:{change:e.hashRename},model:{value:e.isHashRename,callback:function(t){e.isHashRename=t},expression:"isHashRename"}})],1),n("div",{staticClass:"tool-item operation-btn"},[n("el-button",{attrs:{plain:"",icon:"el-icon-refresh"},on:{click:e.uploadReset}},[e._v("重置")]),n("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-upload"},on:{click:e.uploadFile}},[e._v("上传")])],1)])},F=[],G={name:"UploadTools",data:function(){return{setMaxSize:!1,maxSize:200,isRename:!1,isHashRename:!0,newName:""}},props:{isShowRename:{type:Boolean,default:!1}},mounted:function(){this.hashRename(this.isHashRename),this.rename(this.isRename),this.setMaxSizeChange(this.setMaxSize),this.maxSizeChange(this.maxSize)},watch:{isShowRename:function(e){this.isRename=!1,this.newName=e?"xxx":""}},methods:{rename:function(){this.$emit("rename",{isRename:this.isRename,newName:this.newName})},hashRename:function(e){this.$emit("hash-named",e)},setMaxSizeChange:function(e){this.$emit("is-set-max-size",e)},maxSizeChange:function(e){this.$emit("max-size",e)},uploadReset:function(){this.$emit("upload-reset")},uploadFile:function(){this.$emit("upload-file")}}},J=G,A=(n("ca20"),Object(p["a"])(J,P,F,!1,null,"3abc1570",null)),Y=A.exports,X=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",e._l(e.uploadedList,(function(t){return n("el-card",{directives:[{name:"loading",rawName:"v-loading",value:t.deleting,expression:"item.deleting"}],staticClass:"uploaded-image",attrs:{"body-style":{padding:"0"},"element-loading-text":"删除中...","element-loading-background":"rgba(0, 0, 0, 0.6)"}},[n("img",{staticClass:"image",attrs:{src:t.cdn_url}}),n("div",{staticClass:"image-info"},[n("div",{staticClass:"filename"},[e._v(e._s(t.name))]),n("div",{staticClass:"image-operation"},[n("el-tooltip",{attrs:{content:"删除该图片",placement:"top"}},[n("i",{staticClass:"el-icon-delete",on:{click:function(n){return e.deleteImage(t)}}})]),n("el-tooltip",{attrs:{content:"复制GitHub外链",placement:"top"}},[n("i",{staticClass:"el-icon-document-copy",on:{click:function(n){return e.copyExternalLink("GitHub",t)}}})]),n("el-tooltip",{attrs:{content:"复制CDN外链",placement:"top"}},[n("i",{staticClass:"el-icon-copy-document",on:{click:function(n){return e.copyExternalLink("CDN",t)}}})])],1)])])})),1)},q=[],B=(n("c740"),n("a434"),{name:"UploadedList",data:function(){return{userConfigInfo:{}}},props:{uploadedList:{type:Array,default:function(){return[]}}},mounted:function(){this.getUserConfigInfo()},methods:{getUserConfigInfo:function(){var e=localStorage.getItem(c);e&&(this.userConfigInfo=JSON.parse(e))},deleteImage:function(e){var t,n,a,o,s,i=this;e.deleting=!0,this.$axios.delete("/repos/".concat(null===(t=this.userConfigInfo)||void 0===t?void 0:t.owner,"/").concat(null===(n=this.userConfigInfo)||void 0===n?void 0:n.selectedRepos,"/contents/").concat(e.path),{headers:{"Content-Type":"application/json",Authorization:"token ".concat(null===(a=this.userConfigInfo)||void 0===a?void 0:a.token)},data:{owner:null===(o=this.userConfigInfo)||void 0===o?void 0:o.owner,repo:null===(s=this.userConfigInfo)||void 0===s?void 0:s.selectedRepos,path:e.path,message:"delete from PicX",sha:e.sha}}).then((function(t){if(console.log("delete res: ",t),200===t.status){e.deleting=!1;var n=i.$parent.$data.uploadedList,a=n.findIndex((function(t){return t.sha===e.sha}));n.splice(a,1),sessionStorage.setItem(c,JSON.stringify(n)),i.$message.success("删除成功！")}}))},copyExternalLink:function(e,t){var n="";switch(e){case"GitHub":n=t.github_url;break;case"CDN":n=t.cdn_url;break}var a=document.createElement("textarea");a.value=n,a.style.position="absolute",a.style.left="-99999px",document.body.appendChild(a),a.select(),document.execCommand("copy"),this.$message.success("".concat(e,"外链复制成功！"))}}}),K=B,Q=(n("83a6"),Object(p["a"])(K,X,q,!1,null,"27623143",null)),V=Q.exports,W=n("5c96"),Z=n.n(W);function ee(e,t,n){n&&n(e,t)}function te(e,t,n){var a=document.createElement("canvas"),o=a.getContext("2d"),s=e.width/e.height,i=n,r=n/s;a.width=i,a.height=r,o.fillStyle="#fff",o.fillRect(0,0,a.width,a.height),o.drawImage(e,0,0,i,r);var l=a.toDataURL(t,.75);return a=o=null,l}function ne(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(e)if(/\/(?:jpeg|jpg|png|gif)/i.test(e.type)){var a=new FileReader;a.readAsDataURL(e),a.onload=function(){var a=this.result;if(null===n||a.length<=n)ee(a,e.name,t);else{var o=new Image;o.src=a,o.onload=function(){var a=te(o,e.type,n/1024);ee(a,e.name,t),o=null}}}}else Z.a.Message.error("该文件不是图片格式！")}var ae=ne,oe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:204800;if(e.clipboardData&&e.clipboardData.items)return new Promise((function(n){for(var a=0,o=e.clipboardData.items.length;a<o;a++){var s=e.clipboardData.items[a];if("file"===s.kind){var i=s.getAsFile();ae(i,(function(e,t){n({url:e,fileName:t})}),t)}}}))},se=oe,ie=(n("baa5"),function(e){var t=e.lastIndexOf("."),n=e.substr(0,t),a=e.substr(t,e.length),o=Math.random().toString(36).substr(2);return{name:n,hash:o,suffix:a}}),re=ie,le=function(e,t){var n=e.selectedDir+"/";return"nonuseDir"===e.dirMode&&(n=""),"/repos/".concat(e.owner,"/").concat(e.selectedRepos,"/contents/").concat(n).concat(t)},ce=le,ue=function(e,t,n){switch(e){case"github":return t["download_url"];case"cdn":return"https://cdn.jsdelivr.net/gh/".concat(n.owner,"/").concat(n.selectedRepos,"/").concat(t["path"])}},fe=ue,de={name:"Upload",components:{UploadTools:Y,UploadedList:V},data:function(){return{compressSize:200,imgData:{base64Content:"",base64Url:""},filename:{initName:"",prev:"",now:"",name:"",hash:"",suffix:""},setMaxSize:!1,isHashRename:!1,isRename:!1,uploadStatus:{progress:0,uploading:!1},autoUpload:!1,externalLink:{github:"",cdn:""},userConfigInfo:{},uploadedList:[]}},mounted:function(){this.getUserConfigInfo();var e=sessionStorage.getItem(c);e&&(this.uploadedList=JSON.parse(e))},watch:{logoutStatus:function(e){e||(this.resetUploadInfo(),this.uploadedList=[],this.userConfigInfo={},sessionStorage.removeItem(c))}},computed:Object(l["a"])({},Object(u["b"])({logoutStatus:"getUserLoggingStatus"})),methods:{getUserConfigInfo:function(){var e=localStorage.getItem(c);e&&(this.userConfigInfo=JSON.parse(e))},onSetMaxSizeChane:function(e){this.setMaxSize=e},hashRename:function(e){this.isHashRename=e,this.isHashRename?this.filename.now="".concat(this.filename.name,".").concat(this.filename.hash).concat(this.filename.suffix):this.filename.now="".concat(this.filename.name).concat(this.filename.suffix)},rename:function(e){var t=e.isRename,n=e.newName;this.filename.name=t?n:this.filename.initName,this.isHashRename?this.filename.now="".concat(this.filename.name,".").concat(this.filename.hash).concat(this.filename.suffix):this.filename.now="".concat(this.filename.name).concat(this.filename.suffix)},onMaxSizeChange:function(e){this.compressSize=e},resetUploadInfo:function(){L(this.imgData),L(this.uploadStatus),L(this.filename),L(this.externalLink)},uploadImage:function(){var e=this;if(!Object.keys(this.userConfigInfo).length)return this.$message.error("请先进行图床配置！"),void this.$router.push("config");if(this.imgData.base64Content&&this.filename.now)if(this.filename.now!==this.filename.prev){this.uploadStatus.uploading=!0;var t={message:"upload from PicX",branch:"master",committer:{name:this.userConfigInfo.owner,email:this.userConfigInfo.email},content:this.imgData.base64Content};this.$axios.put(ce(this.userConfigInfo,this.filename.now),t,{headers:{"Content-Type":"application/json",Authorization:"token ".concat(this.userConfigInfo.token)}}).then((function(t){console.log("res",t),201===t.status&&"Created"===t.statusText&&(e.$message.success("上传成功！"),e.uploadedHandle(t))})).catch((function(t){e.$message.error("上传失败！"),console.log("error",t)}))}else this.$message.error("该图片已上传！");else this.$message.error("内容不能为空！")},uploadedHandle:function(e){this.uploadStatus.progress=100,this.uploadStatus.uploading=!1,this.filename.prev=this.filename.now,this.externalLink.github=fe("github",e.data.content,this.userConfigInfo),this.externalLink.cdn=fe("cdn",e.data.content,this.userConfigInfo),this.uploadedList.unshift({name:e.data.content.name,path:e.data.content.path,sha:e.data.content.sha,api_url:e.data.content.url,html_url:e.data.content.html_url,github_url:this.externalLink.github,cdn_url:this.externalLink.cdn,deleting:!1}),sessionStorage.setItem(c,JSON.stringify(this.uploadedList))},copyLink:function(e){switch(e){case"CDN":this.$refs.CDNExternalLinkInput.select();break;case"GitHub":this.$refs.GitHubExternalLinkInput.select();break}document.execCommand("copy"),this.$message.success("".concat(e,"外链复制成功！"))},getImage:function(e,t){this.imgData.base64Url=e,this.imgData.base64Content=e.split(",")[1],L(this.uploadStatus);var n=re(t),a=n.name,o=n.hash,s=n.suffix;this.filename.name=a,this.filename.hash=o,this.filename.suffix=s,this.filename.now=this.isHashRename?"".concat(a,".").concat(o).concat(s):t,this.filename.initName=this.filename.name,this.autoUpload&&this.uploadImage()},onFileChange:function(e){var t=this,n=e.target.files[0];ae(n,(function(e,n){t.getImage(e,n)}),this.setMaxSize?1024*this.compressSize:null)},onDrop:function(e){var t=this,n=e.dataTransfer.files[0];ae(n,(function(e,n){t.getImage(e,n)}),this.setMaxSize?1024*this.compressSize:null)},onPaste:function(e){var t=this;return Object(T["a"])(regeneratorRuntime.mark((function n(){var a,o,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,se(e,t.setMaxSize?1024*t.compressSize:null);case 2:a=n.sent,o=a.url,s=a.fileName,t.getImage(o,s);case 6:case"end":return n.stop()}}),n)})))()}}},pe=de,ge=(n("7160"),Object(p["a"])(pe,E,H,!1,null,null,null)),he=ge.exports,me=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},ve=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h1",[e._v("coming soon...")])])}],Ce={name:"Management",data:function(){return{userConfigInfo:null}},mounted:function(){this.getUserConfigInfo()},methods:{getUserConfigInfo:function(){var e=localStorage.getItem(c);e&&(this.userConfigInfo=JSON.parse(e))},getReposInfo:function(){var e,t;this.userConfigInfo&&k.a.get("https://api.github.com/repos/".concat(null===(e=this.userConfigInfo)||void 0===e?void 0:e.username,"/").concat(null===(t=this.userConfigInfo)||void 0===t?void 0:t.selectedRepos,"/contents")).then((function(e){console.log("res",e)}))}}},Ie=Ce,be=Object(p["a"])(Ie,me,ve,!1,null,"acd3c04a",null),_e=be.exports,we=b["a"].prototype.push;b["a"].prototype.push=function(e){return we.call(this,e).catch((function(e){return e}))},a["default"].use(b["a"]);var Se=[{path:"/",name:"Index",redirect:{name:"Upload"}},{path:"/upload",name:"Upload",component:he,meta:{title:"图片上传 | PicX 图床神器"}},{path:"/config",name:"Config",component:z,meta:{title:"图床配置 | PicX 图床神器"}},{path:"/management",name:"Management",component:_e,meta:{title:"图片管理 | PicX 图床神器"}},{path:"*",redirect:{name:"Upload"}}],xe=new b["a"]({routes:Se});xe.beforeEach((function(e,t,n){e.meta.title&&(document.title=e.meta.title),n()}));var ke=xe;a["default"].use(u["a"]);var Ue=function(){var e=localStorage.getItem(c);return e?JSON.parse(e):U},ye=new u["a"].Store({state:{userConfigInfo:Ue(),isLogout:!1},mutations:{SET_USER_CONFIG_INFO:function(e,t){for(var n in t)e.userConfigInfo.hasOwnProperty(n)&&(e.userConfigInfo[n]=t[n])},PERSIST_USER_CONFIG_INFO:function(e){localStorage.setItem(c,JSON.stringify(e.userConfigInfo))},RESET_USER_CONFIG_INFO:function(e){L(e.userConfigInfo)}},getters:{getUserConfigInfo:function(e){return JSON.parse(JSON.stringify(e.userConfigInfo))},getUserAvatar:function(e){return e.userConfigInfo.avatar_url},getUserName:function(e){return e.userConfigInfo.name},getUserLoggingStatus:function(e){return e.userConfigInfo.loggingStatus}},actions:{LOGOUT:function(e){var t=e.commit,n=e.state;t("RESET_USER_CONFIG_INFO"),n.userConfigInfo.loggingStatus=!1,localStorage.removeItem(c)}},modules:{}});n("0fae");k.a.defaults.baseURL="https://api.github.com",k.a.interceptors.request.use((function(e){return e})),k.a.interceptors.response.use((function(e){return e}),(function(e){if(e.response&&e.response.data){var t=e.response.status,n=e.response.data.message;Z.a.Message.error({message:"Code: ".concat(t,", Message: ").concat(n),duration:4e3}),console.error(e.response)}return e.response})),a["default"].use(Z.a),a["default"].prototype.$axios=k.a,a["default"].config.productionTip=!1,new a["default"]({router:ke,store:ye,render:function(e){return e(I)}}).$mount("#app")},"5c0b":function(e,t,n){"use strict";var a=n("9c0c"),o=n.n(a);o.a},7160:function(e,t,n){"use strict";var a=n("086a"),o=n.n(a);o.a},"7b09":function(e,t,n){},"83a6":function(e,t,n){"use strict";var a=n("7b09"),o=n.n(a);o.a},"9c0c":function(e,t,n){},abad:function(e,t,n){"use strict";var a=n("d49f"),o=n.n(a);o.a},ca20:function(e,t,n){"use strict";var a=n("ca6b"),o=n.n(a);o.a},ca6b:function(e,t,n){},d49f:function(e,t,n){}});
//# sourceMappingURL=app.8ac2b1e2.js.map