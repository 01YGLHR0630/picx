var e=Object.assign;import{d as t,r as a,o as n,a as o,c as s,b as i,e as l,f as r,t as d,u,g as c,p as g,h as m,i as p,j as f,k as I,w as h,l as _,v as C,m as L,F as v,n as D,q as b,s as U,x as S,y as A,z as E,A as O,B as k,C as R,D as w,E as T,G as y,H as M}from"./vendor.e7a27f28.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(a){const n=new URL(e,location),o=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((a,s)=>{const i=new URL(e,n);if(self[t].moduleMap[i])return a(self[t].moduleMap[i]);const l=new Blob([`import * as m from '${i}';`,`${t}.moduleMap['${i}']=m;`],{type:"text/javascript"}),r=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(l),onerror(){s(new Error(`Failed to import: ${e}`)),o(r)},onload(){a(self[t].moduleMap[i]),o(r)}});document.head.appendChild(r)})),self[t].moduleMap={}}}("assets/");var x=t({name:"site-count",setup(){const e=a(null);return n((()=>{const t=document.createElement("script");t.async=!0,t.src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",e.value.appendChild(t)})),{siteCountDom:e}}});const G={class:"site-count",ref:"siteCountDom"},P=i("span",{id:"busuanzi_value_site_pv"},null,-1);x.render=function(e,t,a,n,i,l){return o(),s("span",G,[P],512)};var N=t({name:"Header",components:{siteCount:x},setup(){const t=u(),a=c(),n=l({defaultUsername:"未登录",userConfigInfo:r((()=>a.state.userConfigInfo))});return e(e({},d(n)),{router:t,onUserInfoClick:()=>{n.userConfigInfo.loggingStatus||"/config"===t.currentRoute.value.path||t.push("/config")},handleCommand:e=>{switch(e){case"upload":t.push("/");break;case"config":t.push("/config");break;case"management":t.push("/management");break;case"logout":a.dispatch("LOGOUT"),t.push("/config")}},goGitHubRepo:()=>{window.open("https://github.com/XPoet/picx")}})}});const V=h("data-v-06c1be40");g("data-v-06c1be40");const $={class:"header"},j={class:"header-left"},z=i("div",{class:"logo"},[i("img",{src:"./assets/logo.206d082d.png",alt:"PicX"})],-1),F=i("div",{class:"title"},"PicX",-1),B={class:""},H=_(" 有 "),X=_(" 位小伙伴使用 PicX 图床神器"),J={class:"header-right"},Y={class:"username"},q={key:0,class:"avatar"},W=i("i",{class:"el-icon-user-solid"},null,-1),K={class:"el-dropdown-link"},Q={class:"avatar"},Z=_(" 退出登录 ");m();const ee=V(((e,t,a,n,l,r)=>{var d,u;const c=p("siteCount"),g=p("el-tooltip"),m=p("el-dropdown-item"),h=p("el-dropdown-menu"),_=p("el-dropdown");return o(),s("header",$,[i("div",j,[i("div",{class:"brand",onClick:t[1]||(t[1]=t=>e.router.push("/"))},[z,F]),i("div",{class:"website-count",onClick:t[2]||(t[2]=(...t)=>e.goGitHubRepo&&e.goGitHubRepo(...t))},[i(g,{effect:"light",content:"点个 Star 支持一下作者吧(*￣︶￣)",placement:"bottom"},{default:V((()=>[i("i",B,[H,i(c),X])])),_:1})])]),i("div",J,[i("div",{class:"user-info",onClick:t[3]||(t[3]=(...t)=>e.onUserInfoClick&&e.onUserInfoClick(...t))},[i("div",Y,f(e.userConfigInfo.owner?e.userConfigInfo.owner:e.defaultUsername),1),(null==(d=e.userConfigInfo)?void 0:d.avatarUrl)?I("",!0):(o(),s("div",q,[W])),(null==(u=e.userConfigInfo)?void 0:u.avatarUrl)?(o(),s(_,{key:1,trigger:"click",onCommand:e.handleCommand},{dropdown:V((()=>[i(h,null,{default:V((()=>[i(m,{command:"logout"},{default:V((()=>[Z])),_:1})])),_:1})])),default:V((()=>{var t,a;return[i("span",K,[i("span",Q,[i("img",{src:null==(t=e.userConfigInfo)?void 0:t.avatarUrl,alt:null==(a=e.userConfigInfo)?void 0:a.owner},null,8,["src","alt"])])])]})),_:1},8,["onCommand"])):I("",!0)])])])}));N.render=ee,N.__scopeId="data-v-06c1be40";var te=t({name:"Nav",setup(){const t=u(),a=c(),o=l({userConfigInfo:r((()=>a.getters.getUserConfigInfo)).value,navList:[{name:"配置",icon:"el-icon-edit-outline",isActive:!1,path:"/config"},{name:"上传",icon:"el-icon-upload2",isActive:!1,path:"/upload"},{name:"管理",icon:"el-icon-box",isActive:!1,path:"/management"},{name:"帮助",icon:"el-icon-chat-dot-round",isActive:!1,path:"/help"}],navClick(e){const a=e.path;if("/management"===a){if(""===this.userConfigInfo.selectedRepos)return C.warning("请选择一个仓库！"),void t.push("/config");if(""===this.userConfigInfo.selectedDir)return C.warning("目录不能为空！"),void t.push("/config")}t.push(a)}}),s=e=>{o.navList.forEach((t=>t.isActive=t.path===e))};return L((()=>t.currentRoute.value),((e,t)=>{s(e.path)})),n((()=>{t.isReady().then((()=>{s(t.currentRoute.value.path)}))})),e({},d(o))}});const ae=h("data-v-43f022de");g("data-v-43f022de");const ne={class:"nav"},oe={class:"nav-list"},se={class:"nav-content"},ie={class:"nav-name"};m();const le=ae(((e,t,a,n,l,r)=>(o(),s("aside",ne,[i("ul",oe,[(o(!0),s(v,null,D(e.navList,(t=>b((o(),s("li",{class:["nav-item flex-center",{active:t.isActive}],onClick:a=>e.navClick(t)},[i("div",se,[i("i",{class:["nav-icon",t.icon]},null,2),i("span",ie,f(t.name),1)])],10,["onClick"])),[[U,"/management"!==t.path||e.userConfigInfo.loggingStatus]]))),256))])]))));te.render=le,te.__scopeId="data-v-43f022de";const re=h("data-v-3b9b068c");g("data-v-3b9b068c");const de={key:0,class:"image-box"};m();var ue=t({expose:[],setup(e){const t=c(),a=r((()=>t.getters.getImageViewer));return re(((e,t)=>S(a).isShow?(o(),s("div",{key:0,class:"image-viewer",onClick:t[1]||(t[1]=e=>S(a).isShow=!1)},[S(a).url?(o(),s("div",de,[i("img",{class:"img",src:S(a).url},null,8,["src"])])):I("",!0)])):I("",!0)))}});ue.__scopeId="data-v-3b9b068c";const ce=h("data-v-4dd951bb");g("data-v-4dd951bb");const ge={class:"top"},me={class:"bottom"},pe={class:"left"},fe={class:"right"},Ie={class:"content"};m();var he=t({expose:[],setup(e){const t=c(),a=e=>{t.commit("CHANGE_UPLOAD_AREA_ACTIVE",e.target.classList.contains("active-upload"))};return ce(((e,t)=>{const n=p("router-view");return o(),s(v,null,[i("main",{class:"main-container",onClick:a},[i("div",ge,[i(N)]),i("div",me,[i("div",pe,[i(te)]),i("div",fe,[i("div",Ie,[i(n)])])])]),i(ue)],64)}))}});he.__scopeId="data-v-4dd951bb";var _e=t({name:"App",components:{Main:he}});_e.render=function(e,t,a,n,i,l){const r=p("Main");return o(),s(r)};let Ce;const Le={},ve=A.create({baseURL:"https://api.github.com",timeout:1e4});ve.interceptors.request.use((e=>{const t=window.localStorage.getItem("accessToken");return t&&(e.headers.common.Authorization=t),e}),(e=>Promise.reject(e))),ve.interceptors.response.use((e=>e),(e=>{if(e.response&&e.response.data){const t=e.response.status,a=e.response.data.message;C.error(`Code: ${t}, Message: ${a}`),console.error(e.response)}else C.error(`${e}`);return e.response}));class De{static zerofill(e){return e<10?"0"+e:e}static getYyyyMmDd(e=Date.now()){const t=new Date(e),a=t.getFullYear(),n=t.getMonth()+1,o=t.getDate();return`${a}${this.zerofill(n)}${this.zerofill(o)}`}static formatTimestamp(e=Date.now()){const t=new Date(e);let a=t.getFullYear(),n=t.getMonth()+1,o=t.getDate(),s=t.getHours(),i=t.getMinutes(),l=t.getSeconds();return`${a}-${this.zerofill(n)}-${this.zerofill(o)} ${this.zerofill(s)}:${this.zerofill(i)}:${this.zerofill(l)}`}}var be,Ue;(Ue=be||(be={})).autoDir="autoDir",Ue.newDir="newDir",Ue.rootDir="rootDir",Ue.reposDir="reposDir";var Se=t({name:"Config",setup(){const t=u(),a=c(),n=l({userConfigInfo:r((()=>a.getters.getUserConfigInfo)).value,loggingStatus:r((()=>a.getters.getUserConfigInfo)).value,loading:!1,dirLoading:!1,getUserInfo(){this.userConfigInfo.token?(this.loading=!0,ve.get("/user",{headers:{"Content-Type":"application/json",Authorization:`token ${this.userConfigInfo.token}`}}).then((e=>{e&&200===e.status?(this.saveUserInfo(e),this.getReposList(e.data.repos_url)):this.loading=!1}))):C.warning("Token 不能为空！")},saveUserInfo(e){this.userConfigInfo.loggingStatus=!0,this.userConfigInfo.owner=e.data.login,this.userConfigInfo.name=e.data.name,this.userConfigInfo.email=e.data.email,this.userConfigInfo.avatarUrl=e.data.avatar_url,this.persistUserConfigInfo()},getReposList(e){ve.get(e,{headers:{"Content-Type":"application/json",Authorization:`token ${this.userConfigInfo.token}`}}).then((e=>{if(200===e.status&&e.data.length>0){this.userConfigInfo.reposList=[];for(const t of e.data)t.fork||this.userConfigInfo.reposList.push({value:t.name,label:t.name,desc:t.description});this.loading=!1,this.persistUserConfigInfo()}}))},innerSelectRepos(e){n.getBranchList(e),n.persistUserConfigInfo()},getBranchList(e){this.dirLoading=!0,ve.get(`/repos/${this.userConfigInfo.owner}/${e}/branches`,{headers:{"Content-Type":"application/json",Authorization:`token ${this.userConfigInfo.token}`}}).then((t=>{if(t&&200===t.status){this.dirLoading=!1;const a="master",n="main";t.data.length>0?(t.data.some((e=>e.name===a))?this.userConfigInfo.selectedBranch=a:t.data.some((e=>e.name===n))&&(this.userConfigInfo.selectedBranch=n),this.getDirList(e)):(this.userConfigInfo.selectedBranch=a,this.userConfigInfo.dirMode=be.newDir,this.userConfigInfo.selectedDir="",this.userConfigInfo.dirList=[])}}))},getDirList(e){this.dirLoading=!0,ve.get(`/repos/${this.userConfigInfo.owner}/${e}/contents`,{headers:{"Content-Type":"application/json",Authorization:`token ${this.userConfigInfo.token}`}}).then((e=>{if(e&&200===e.status&&e.data.length>0){this.userConfigInfo.dirList=[{value:"/",label:"/"}];for(const t of e.data)"dir"===t.type&&this.userConfigInfo.dirList.push({value:t.name,label:t.name});this.persistUserConfigInfo()}this.dirLoading=!1}))},innerDirModeChange(e){switch(e){case be.rootDir:this.userConfigInfo.selectedDir="/";break;case be.autoDir:this.userConfigInfo.selectedDir=De.getYyyyMmDd();break;case be.newDir:case be.reposDir:this.userConfigInfo.selectedDir=""}this.persistUserConfigInfo()},persistUserConfigInfo(){a.dispatch("USER_CONFIG_INFO_PERSIST")},reset(){this.loading=!1,this.dirLoading=!1,a.dispatch("LOGOUT")},innerGoUpload(){const e=this.userConfigInfo.selectedDir,a=this.userConfigInfo.dirMode;let n="目录不能为空！";if(""!==e)t.push("/upload");else{switch(a){case be.newDir:n="请在输入框输入一个新目录！";break;case be.reposDir:n=`请选择 ${this.userConfigInfo.selectedRepos} 仓库下的一个目录！`}C.warning(n)}}});return L((()=>n.loggingStatus),((e,t)=>{e||(n.loading=!1,n.dirLoading=!1)})),e(e({},d(n)),{dirModeChange:e=>{n.innerDirModeChange(e)},selectRepos:e=>{n.innerSelectRepos(e)},goUpload:()=>{n.innerGoUpload()}})}});const Ae=h("data-v-192222aa");g("data-v-192222aa");const Ee={class:"page-container config-page-container"},Oe=_(" 确认 Token "),ke=_("新建目录"),Re=_("根目录"),we=_("自动目录"),Te=_(" 重置 "),ye=_("完成配置 ");m();const Me=Ae(((e,t,a,n,l,r)=>{const d=p("el-input"),u=p("el-form-item"),c=p("el-button"),g=p("el-form"),m=p("el-option"),h=p("el-select"),C=p("el-radio"),L=p("el-tooltip"),U=p("el-radio-group"),S=E("loading");return o(),s("div",Ee,[i(g,{"label-width":"70px","label-position":"right",class:"config-form"},{default:Ae((()=>[i(u,{label:"Token"},{default:Ae((()=>[i(d,{modelValue:e.userConfigInfo.token,"onUpdate:modelValue":t[1]||(t[1]=t=>e.userConfigInfo.token=t),clearable:!0},null,8,["modelValue"])])),_:1}),i(u,{class:"operation"},{default:Ae((()=>[i(c,{plain:"",size:"small",type:"primary",onClick:t[2]||(t[2]=t=>e.getUserInfo())},{default:Ae((()=>[Oe])),_:1})])),_:1})])),_:1}),e.userConfigInfo.token?b((o(),s(g,{key:0,"label-width":"70px","label-position":"right","element-loading-text":"加载中..."},{default:Ae((()=>[e.userConfigInfo.owner?(o(),s(u,{key:0,label:"用户名"},{default:Ae((()=>[i(d,{modelValue:e.userConfigInfo.owner,"onUpdate:modelValue":t[3]||(t[3]=t=>e.userConfigInfo.owner=t),readonly:""},null,8,["modelValue"])])),_:1})):I("",!0),e.userConfigInfo.email?(o(),s(u,{key:1,label:"邮箱"},{default:Ae((()=>[i(d,{modelValue:e.userConfigInfo.email,"onUpdate:modelValue":t[4]||(t[4]=t=>e.userConfigInfo.email=t),readonly:""},null,8,["modelValue"])])),_:1})):I("",!0),e.userConfigInfo.reposList.length?(o(),s(u,{key:2,label:"选择仓库"},{default:Ae((()=>[i(h,{modelValue:e.userConfigInfo.selectedRepos,"onUpdate:modelValue":t[5]||(t[5]=t=>e.userConfigInfo.selectedRepos=t),filterable:"",style:{width:"100%"},placeholder:"请选择图床仓库...",onChange:e.selectRepos},{default:Ae((()=>[(o(!0),s(v,null,D(e.userConfigInfo.reposList,((e,t)=>(o(),s(m,{key:t+"_"+e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1})):I("",!0)])),_:1},512)),[[S,e.loading]]):I("",!0),e.userConfigInfo.selectedRepos?b((o(),s(g,{key:1,"label-width":"70px","label-position":"right","element-loading-text":"加载中..."},{default:Ae((()=>[e.userConfigInfo.reposList.length&&e.userConfigInfo.selectedRepos?(o(),s(u,{key:0,label:"目录方式"},{default:Ae((()=>[i(U,{modelValue:e.userConfigInfo.dirMode,"onUpdate:modelValue":t[6]||(t[6]=t=>e.userConfigInfo.dirMode=t),onChange:e.dirModeChange},{default:Ae((()=>[i(L,{content:"手动输入一个新目录",placement:"top"},{default:Ae((()=>[i(C,{label:"newDir"},{default:Ae((()=>[ke])),_:1})])),_:1}),i(L,{content:"图片存储在 "+e.userConfigInfo.selectedBranch+" 分支的根目录下",placement:"top"},{default:Ae((()=>[i(C,{label:"rootDir"},{default:Ae((()=>[Re])),_:1})])),_:1},8,["content"]),i(L,{content:"根据日期自动创建格式 YYYYMMDD 的目录",placement:"top"},{default:Ae((()=>[i(C,{label:"autoDir"},{default:Ae((()=>[we])),_:1})])),_:1}),e.userConfigInfo.dirList.length?(o(),s(L,{key:0,content:"选择 "+e.userConfigInfo.selectedRepos+" 仓库下的一个目录",placement:"top"},{default:Ae((()=>[i(C,{label:"reposDir"},{default:Ae((()=>[_("选择 "+f(e.userConfigInfo.selectedRepos)+" 仓库目录",1)])),_:1})])),_:1},8,["content"])):I("",!0)])),_:1},8,["modelValue","onChange"])])),_:1})):I("",!0),"autoDir"===e.userConfigInfo.dirMode?(o(),s(u,{key:1,label:"自动目录"},{default:Ae((()=>[i(d,{modelValue:e.userConfigInfo.selectedDir,"onUpdate:modelValue":t[7]||(t[7]=t=>e.userConfigInfo.selectedDir=t),readonly:""},null,8,["modelValue"])])),_:1})):I("",!0),"rootDir"===e.userConfigInfo.dirMode?(o(),s(u,{key:2,label:"根目录"},{default:Ae((()=>[i(d,{modelValue:e.userConfigInfo.selectedDir,"onUpdate:modelValue":t[8]||(t[8]=t=>e.userConfigInfo.selectedDir=t),readonly:""},null,8,["modelValue"])])),_:1})):I("",!0),"newDir"===e.userConfigInfo.dirMode?(o(),s(u,{key:3,label:"新建目录"},{default:Ae((()=>[i(d,{modelValue:e.userConfigInfo.selectedDir,"onUpdate:modelValue":t[9]||(t[9]=t=>e.userConfigInfo.selectedDir=t),onInput:t[10]||(t[10]=t=>e.persistUserConfigInfo()),clearable:"",placeholder:"请输入新建的目录..."},null,8,["modelValue"])])),_:1})):I("",!0),e.userConfigInfo.dirList.length&&"reposDir"===e.userConfigInfo.dirMode?(o(),s(u,{key:4,label:"选择目录"},{default:Ae((()=>[i(h,{modelValue:e.userConfigInfo.selectedDir,"onUpdate:modelValue":t[11]||(t[11]=t=>e.userConfigInfo.selectedDir=t),filterable:"",style:{width:"100%"},placeholder:"请选择目录...",onChange:e.persistUserConfigInfo},{default:Ae((()=>[(o(!0),s(v,null,D(e.userConfigInfo.dirList,(e=>(o(),s(m,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1})):I("",!0)])),_:1},512)),[[S,e.dirLoading]]):I("",!0),i(g,{"label-width":"70px"},{default:Ae((()=>[i(u,{class:"operation"},{default:Ae((()=>[e.userConfigInfo.owner?(o(),s(c,{key:0,plain:"",size:"small",onClick:t[12]||(t[12]=t=>e.reset())},{default:Ae((()=>[Te])),_:1})):I("",!0),e.userConfigInfo.selectedRepos?(o(),s(c,{key:1,plain:"",size:"small",type:"success",onClick:e.goUpload},{default:Ae((()=>[ye])),_:1},8,["onClick"])):I("",!0)])),_:1})])),_:1})])}));var xe,Ge;Se.render=Me,Se.__scopeId="data-v-192222aa",(Ge=xe||(xe={})).gh="gh",Ge.md_gh="md_gh",Ge.cdn="cdn",Ge.md_cdn="md_cdn";var Pe=t({name:"copy-external-link",props:{imgObj:{type:Object,default:()=>({})}},setup:e=>({copyExternalLink:function(t){let a="",n="";switch(t){case xe.gh:e.imgObj.is_transform_md?(a=e.imgObj.md_gh_url,n="Markdown 格式的 GitHub"):(a=e.imgObj.github_url,n="GitHub");break;case xe.cdn:e.imgObj.is_transform_md?(a=e.imgObj.md_cdn_url,n="Markdown 格式的 CDN"):(a=e.imgObj.cdn_url,n="CDN")}let o=document.querySelector(".temp-external-link");o||(o=document.createElement("textarea"),o.setAttribute("class","temp-external-link"),o.style.position="absolute",o.style.top="-99999px",o.style.left="-99999px",document.body.appendChild(o)),o.value=a,o.select(),document.execCommand("copy"),C.success(`${n} 外链复制成功！`)},transformMD:function(){e.imgObj.is_transform_md=!e.imgObj.is_transform_md},externalLinkType:xe})});const Ne=h("data-v-157df113");g("data-v-157df113");const Ve={class:"copy-external-link-box"};m();const $e=Ne(((e,t,a,n,l,r)=>{const d=p("el-tooltip");return o(),s("div",Ve,[i(d,{content:e.imgObj.is_transform_md?"已转换 Markdown 格式":"转换 Markdown 格式",placement:"top"},{default:Ne((()=>[i("span",{class:["btn-item transform-btn",{"is-transform":e.imgObj.is_transform_md}],onClick:t[1]||(t[1]=t=>e.transformMD())}," MD ",2)])),_:1},8,["content"]),i(d,{content:"点击复制 GitHub 外链",placement:"top"},{default:Ne((()=>[i("span",{class:"btn-item copy-url",onClick:t[2]||(t[2]=t=>e.copyExternalLink(e.externalLinkType.gh))}," GitHub ")])),_:1}),i(d,{content:"点击复制 CDN 外链",placement:"top"},{default:Ne((()=>[i("span",{class:"btn-item copy-url",onClick:t[3]||(t[3]=t=>e.copyExternalLink(e.externalLinkType.cdn))}," CDN ")])),_:1})])}));Pe.render=$e,Pe.__scopeId="data-v-157df113";var je=t({name:"ImageCard",components:{copyExternalLink:Pe},props:{imageObj:{type:Object,default:()=>{}},isUploaded:{type:Boolean,default:!1}},setup(){const t=c(),a=l({isEnableDeleted:!0,userConfigInfo:r((()=>t.getters.getUserConfigInfo)).value,deleteImage(e){var a,n,o,s,i;e.deleting=!0,ve.delete(`/repos/${null==(a=this.userConfigInfo)?void 0:a.owner}/${null==(n=this.userConfigInfo)?void 0:n.selectedRepos}/contents/${e.path}`,{headers:{"Content-Type":"application/json",Authorization:`token ${null==(o=this.userConfigInfo)?void 0:o.token}`},data:{owner:null==(s=this.userConfigInfo)?void 0:s.owner,repo:null==(i=this.userConfigInfo)?void 0:i.selectedRepos,path:e.path,message:"delete pictures via PicX(https://github.com/XPoet/picx)",sha:e.sha}}).then((a=>{console.log("delete res: ",a),a&&200===a.status?(e.deleting=!1,C.success("删除成功！"),t.dispatch("UPLOADED_LIST_REMOVE",e),t.dispatch("DIR_IMAGE_LIST_REMOVE",e)):e.deleting=!1}))},imageView(e){t.commit("IMAGE_VIEWER",{isShow:!0,url:e.cdn_url})}});return e({},d(a))}});const ze=h("data-v-ba5f8936");g("data-v-ba5f8936");const Fe={class:"image-card","element-loading-text":"删除中...","element-loading-background":"rgba(0, 0, 0, 0.6)"},Be={class:"image-box"},He={class:"info-box"},Xe={class:"image-info"},Je={class:"filename"},Ye={class:"image-operation"},qe={class:"delete"};m();const We=ze(((e,t,a,n,l,r)=>{const d=p("el-tooltip"),u=p("copyExternalLink"),c=E("loading");return b((o(),s("div",Fe,[i("div",Be,[i("img",{src:e.imageObj.cdn_url,onClick:t[1]||(t[1]=t=>e.imageView(e.imageObj))},null,8,["src"])]),i("div",He,[i("div",Xe,[i("div",Je,f(e.imageObj.name),1),i("div",Ye,[i("div",qe,[i(d,{content:"删除",placement:"top"},{default:ze((()=>[i("i",{class:"el-icon-delete",onClick:t[2]||(t[2]=t=>e.deleteImage(e.imageObj))})])),_:1})]),i("div",null,[i(u,{"img-obj":e.imageObj},null,8,["img-obj"])])])])])],512)),[[c,e.imageObj.deleting]])}));je.render=We,je.__scopeId="data-v-ba5f8936";const Ke=()=>Number(Math.random().toString().substr(2,5)+Date.now()).toString(36),Qe=e=>{const t=e.lastIndexOf("."),a=e.substr(0,t),n=e.substr(t+1,e.length);return{name:a,hash:Ke(),suffix:n}},Ze=e=>{const t=e.indexOf(".");return e.substr(0,t)},et=e=>/(png|jpg|gif|jpeg|webp|svg\+xml)$/.test(e),tt=(e,t,a)=>{const n=`https://cdn.jsdelivr.net/gh/${a.owner}/${a.selectedRepos}@${a.selectedBranch}/${t.path}`,o=decodeURI(t.download_url);switch(e){case xe.gh:return o;case xe.md_gh:return`![${Ze(t.name)}](${o})`;case xe.cdn:return n;case xe.md_cdn:return`![${Ze(t.name)}](${n})`}};var at,nt;(nt=at||(at={})).waitUpload="waitUpload",nt.uploading="uploading",nt.uploaded="uploaded",nt.allUploaded="allUploaded",nt.uploadFail="uploadFail";var ot=t({name:"selected-info-bar",setup(){const t=c(),a=l({userConfigInfo:r((()=>t.getters.getUserConfigInfo))});return e({},d(a))}});const st=h("data-v-06339d16");g("data-v-06339d16");const it={key:0,class:"selected-info-bar-box"},lt={class:"info-item"},rt=_(" 仓库："),dt={key:0,class:"info-item"},ut=_(" 分支："),ct={key:1,class:"info-item"},gt=_(" 目录：");m();const mt=st(((e,t,a,n,l,r)=>{const d=p("el-tag");return e.userConfigInfo.selectedRepos?(o(),s("div",it,[i("span",lt,[rt,i(d,{size:"mini"},{default:st((()=>[_(f(e.userConfigInfo.selectedRepos),1)])),_:1})]),e.userConfigInfo.selectedBranch?(o(),s("span",dt,[ut,i(d,{size:"mini"},{default:st((()=>[_(f(e.userConfigInfo.selectedBranch),1)])),_:1})])):I("",!0),e.userConfigInfo.selectedDir?(o(),s("span",ct,[gt,i(d,{size:"mini"},{default:st((()=>[_(f(e.userConfigInfo.selectedDir),1)])),_:1})])):I("",!0)])):I("",!0)}));ot.render=mt,ot.__scopeId="data-v-06339d16";var pt=t({name:"to-upload-image-card",components:{copyExternalLink:Pe,selectedInfoBar:ot},props:{loadingAllImage:{type:Boolean,default:!1}},setup(){const t=c(),a=l({userConfigInfo:r((()=>t.getters.getUserConfigInfo)).value,toUploadImage:r((()=>t.getters.getToUploadImage)),hashRename(e,t){t.filename.now=e?`${t.filename.name}.${t.filename.hash}.${t.filename.suffix}`:`${t.filename.name}.${t.filename.suffix}`},rename(e,t){t.filename.name=e?t.filename.newName:t.filename.initName,t.filename.isHashRename?t.filename.now=`${t.filename.name}.${t.filename.hash}.${t.filename.suffix}`:t.filename.now=`${t.filename.name}.${t.filename.suffix}`},getFileSize:e=>(e=>(e/1024).toFixed(2)+" KB")(e),formatLastModified:e=>De.formatTimestamp(e),async uploadImage_all(e){const t=this.toUploadImage.uploadedNumber;return t>=this.toUploadImage.list.length?at.uploaded:!0===await this.uploadImage_single(e,this.toUploadImage.list[t])?t<this.toUploadImage.list.length?(await this.uploadImage_all(e),at.allUploaded):at.uploaded:at.uploadFail},uploadImage_single(e,a){const{token:n,selectedBranch:o,email:s,owner:i}=e;a.uploadStatus.uploading=!0;const l={message:"Upload pictures via PicX(https://github.com/XPoet/picx)",branch:o,content:a.imgData.base64Content};return""!==s&&(l.committer={name:i,email:s}),new Promise(((o,s)=>{ve.put(((e,t)=>{let a="";return"/"!==e.selectedDir&&(a=e.selectedDir+"/"),`/repos/${e.owner}/${e.selectedRepos}/contents/${a}${t}`})(e,a.filename.now),l,{headers:{"Content-Type":"application/json",Authorization:`token ${n}`}}).then((n=>{n&&201===n.status?(this.uploadedHandle(n,a,e),t.dispatch("TO_UPLOAD_IMAGE_UPLOADED",a.uuid),o(!0),C.success("上传成功！")):(a.uploadStatus.uploading=!1,o(!1),C.error("上传失败！"))})).catch((e=>{s(e)}))}))},uploadedHandle(e,a,n){a.uploadStatus.progress=100,a.uploadStatus.uploading=!1,a.externalLink.github=tt(xe.gh,e.data.content,n),a.externalLink.cdn=tt(xe.cdn,e.data.content,n),a.externalLink.markdown_gh=tt(xe.md_gh,e.data.content,n),a.externalLink.markdown_cdn=tt(xe.md_cdn,e.data.content,n);const o={uuid:a.uuid,dir:n.selectedDir,name:e.data.content.name,path:e.data.content.path,sha:e.data.content.sha,github_url:a.externalLink.github,cdn_url:a.externalLink.cdn,md_gh_url:a.externalLink.markdown_gh,md_cdn_url:a.externalLink.markdown_cdn,is_transform_md:!1,deleting:!1};a.uploadedImg=o,n.dirList.some((e=>e.value===o.dir))||(t.dispatch("USER_CONFIG_INFO_ADD_DIR",o.dir),t.dispatch("DIR_IMAGE_LIST_ADD_DIR",o.dir)),t.dispatch("UPLOADED_LIST_ADD",o),t.dispatch("DIR_IMAGE_LIST_ADD_IMAGE",o)}});return e(e({},d(a)),{removeToUploadImage:e=>{t.dispatch("TO_UPLOAD_IMAGE_LIST_REMOVE",e.uuid)}})}});const ft={key:0,class:"to-upload-image-list-card"},It={class:"header"},ht={key:0},_t={key:0,class:"body"},Ct={class:"image-uploading-info-box"},Lt={class:"left-image-box flex-center"},vt={class:"image-box"},Dt={class:"right-operation-box"},bt={class:"top"},Ut={class:"image-name"},St={class:"image-info"},At={class:"file-size item"},Et={class:"last-modified item"},Ot={key:0,class:"bottom rename-operation"},kt={key:1,class:"bottom rename-operation"},Rt={key:0,class:"el-icon-upload2"},wt={key:1,class:"el-icon-loading"},Tt={key:2,class:"el-icon-check"},yt=i("i",{class:"el-icon-delete"},null,-1);function Mt(e,t,a){a&&a(e,t)}pt.render=function(e,t,a,n,l,r){const d=p("selectedInfoBar"),u=p("el-checkbox"),c=p("el-input"),g=p("copyExternalLink"),m=p("el-tooltip");return e.toUploadImage.list.length||e.userConfigInfo.selectedRepos?(o(),s("div",ft,[i("div",It,[i("div",null,[i(d)]),i("div",null,[e.toUploadImage.list.length?(o(),s("span",ht,"已上传："+f(e.toUploadImage.uploadedNumber)+" / "+f(e.toUploadImage.list.length),1)):I("",!0)])]),e.toUploadImage.list.length?(o(),s("div",_t,[i("ul",Ct,[(o(!0),s(v,null,D(e.toUploadImage.list,((t,a)=>(o(),s("li",{class:["image-uploading-info-item",{disable:e.loadingAllImage}],key:a},[i("div",Lt,[i("div",vt,[i("img",{src:t.imgData.base64Url},null,8,["src"])])]),i("div",Dt,[i("div",bt,[i("div",Ut,f(t.filename.now),1),i("div",St,[i("span",At,f(e.getFileSize(t.fileInfo.size)),1),i("span",Et,f(e.formatLastModified(t.fileInfo.lastModified)),1)])]),t.uploadStatus.uploading||100===t.uploadStatus.progress?I("",!0):(o(),s("div",Ot,[i(u,{label:"哈希化",modelValue:t.filename.isHashRename,"onUpdate:modelValue":e=>t.filename.isHashRename=e,onChange:a=>e.hashRename(a,t)},null,8,["modelValue","onUpdate:modelValue","onChange"]),i(u,{label:"重命名",modelValue:t.filename.isRename,"onUpdate:modelValue":e=>t.filename.isRename=e,onChange:a=>e.rename(a,t)},null,8,["modelValue","onUpdate:modelValue","onChange"]),t.filename.isRename?(o(),s(c,{key:0,class:"rename-input",size:"mini",modelValue:t.filename.newName,"onUpdate:modelValue":e=>t.filename.newName=e,onInput:a=>e.rename(a,t),clearable:""},null,8,["modelValue","onUpdate:modelValue","onInput"])):I("",!0)])),t.uploadStatus.uploading||100!==t.uploadStatus.progress?I("",!0):(o(),s("div",kt,[i(g,{"img-obj":t.uploadedImg},null,8,["img-obj"])]))]),i("div",{class:["upload-status-box",{"wait-upload":!t.uploadStatus.uploading&&100!==t.uploadStatus.progress,uploading:t.uploadStatus.uploading&&100!==t.uploadStatus.progress,uploaded:!t.uploadStatus.uploading&&100===t.uploadStatus.progress}]},[t.uploadStatus.uploading||100===t.uploadStatus.progress?I("",!0):(o(),s("i",Rt)),t.uploadStatus.uploading&&100!==t.uploadStatus.progress?(o(),s("i",wt)):I("",!0),t.uploadStatus.uploading||100!==t.uploadStatus.progress?I("",!0):(o(),s("i",Tt))],2),100===t.uploadStatus.progress||t.uploadStatus.uploading?I("",!0):(o(),s("div",{key:0,class:"remove-to-upload-image",onClick:a=>e.removeToUploadImage(t)},[i(m,{effect:"dark",content:"移除",placement:"top"},{default:O((()=>[yt])),_:1})],8,["onClick"]))],2)))),128))])])):I("",!0)])):I("",!0)};const xt=(e,t,a=0)=>{if(!e)return;if(!et(e.type))return void C.error("该文件不是图片格式！");const n=new FileReader;n.readAsDataURL(e),n.onload=function(){const n=this.result;if(null===a||n.length<=a)return void Mt(n,e,t);let o=new Image;o.src=n,o.onload=function(){Mt(function(e,t,a){let n=document.createElement("canvas"),o=n.getContext("2d");const s=a,i=a/(e.width/e.height);n.width=s,n.height=i,o.fillStyle="#fff",o.fillRect(0,0,n.width,n.height),o.drawImage(e,0,0,s,i);const l=n.toDataURL(t,.75);return n=o=null,l}(o,e.type,a/1024),e,t),o=null}}};var Gt=t({name:"upload-area",props:{imageLoading:{type:Boolean,default:!1}},setup(){const t=c(),a=l({uploadAreaActive:r((()=>t.getters.getUploadAreaActive)),uploadSettings:r((()=>t.getters.getUploadSettings)).value,toUploadImage:r((()=>t.getters.getToUploadImage)),onSelect(e){t.commit("CHANGE_UPLOAD_AREA_ACTIVE",!0);for(const t of e.target.files)xt(t,((e,t)=>{this.getImage(e,t)}),this.uploadSettings.isSetMaxSize?1024*this.uploadSettings.compressSize:null)},onDrop(e){const a=e.dataTransfer.files[0];xt(a,((e,t)=>{this.getImage(e,t)}),this.uploadSettings.isSetMaxSize?1024*this.uploadSettings.compressSize:null),t.commit("CHANGE_UPLOAD_AREA_ACTIVE",!0)},async onPaste(e){const{url:t,file:a}=await((e,t=204800)=>{if(e.clipboardData&&e.clipboardData.items)return new Promise((a=>{for(let n=0,o=e.clipboardData.items.length;n<o;n++){const o=e.clipboardData.items[n];if("file"===o.kind){const e=o.getAsFile();xt(e,((e,t)=>{a({url:e,file:t})}),t)}}}))})(e,this.uploadSettings.isSetMaxSize?1024*this.uploadSettings.compressSize:null);this.getImage(t,a)},getImage(e,a){this.toUploadImage.list.length===this.toUploadImage.uploadedNumber&&this.toUploadImage.list.length>0&&this.toUploadImage.uploadedNumber>0&&(t.dispatch("TO_UPLOAD_IMAGE_CLEAN_LIST"),t.dispatch("TO_UPLOAD_IMAGE_CLEAN_UPLOADED_NUMBER"));const n={uuid:"",uploadStatus:{progress:0,uploading:!1},imgData:{base64Content:"",base64Url:""},fileInfo:{size:0,lastModified:0},filename:{name:"",hash:"",suffix:"",now:"",initName:"",newName:"xxx",isHashRename:!0,isRename:!1},externalLink:{github:"",cdn:"",markdown_gh:"",markdown_cdn:""}};n.imgData.base64Url=e,n.imgData.base64Content=e.split(",")[1];const{name:o,hash:s,suffix:i}=Qe(a.name);n.uuid=s,n.fileInfo.size=a.size,n.fileInfo.lastModified=a.lastModified,n.filename.name=o,n.filename.hash=s,n.filename.suffix=i,n.filename.now=`${o}.${s}.${i}`,n.filename.initName=o,t.dispatch("TO_UPLOAD_IMAGE_LIST_ADD",JSON.parse(JSON.stringify(n))),t.dispatch("TO_UPLOAD_IMAGE_SET_CURRENT",{uuid:s,base64Url:e})}});return e({},d(a))}});const Pt=h("data-v-e422b292");g("data-v-e422b292");const Nt={key:0,for:"uploader",class:"active-upload"},Vt={key:1,class:"tips active-upload"},$t=i("i",{class:"icon el-icon-upload active-upload"},null,-1),jt=i("div",{class:"text active-upload"},"拖拽、粘贴、或点击此处上传",-1);m();const zt=Pt(((e,t,a,n,l,r)=>{const d=E("loading");return b((o(),s("div",{class:["upload-area active-upload",{focus:e.uploadAreaActive}],onDragover:t[2]||(t[2]=k((()=>{}),["prevent"])),onDrop:t[3]||(t[3]=k(((...t)=>e.onDrop&&e.onDrop(...t)),["stop","prevent"])),onPaste:t[4]||(t[4]=(...t)=>e.onPaste&&e.onPaste(...t)),"element-loading-text":"图片上传中...","element-loading-background":"rgba(0, 0, 0, 0.5)"},[e.uploadAreaActive?(o(),s("label",Nt)):I("",!0),i("input",{id:"uploader",type:"file",onChange:t[1]||(t[1]=(...t)=>e.onSelect&&e.onSelect(...t)),multiple:"multiple"},null,32),e.toUploadImage.curImgBase64Url?I("",!0):(o(),s("div",Vt,[$t,jt])),e.toUploadImage.curImgBase64Url?(o(),s("img",{key:2,class:"active-upload",src:e.toUploadImage.curImgBase64Url,alt:"Pictures to be uploaded"},null,8,["src"])):I("",!0)],34)),[[d,e.imageLoading]])}));Gt.render=zt,Gt.__scopeId="data-v-e422b292";var Ft=t({name:"Upload",components:{ImageCard:je,ToUploadImageCard:pt,UploadArea:Gt},setup(){const t=c(),n=u(),o=a(null),s=a(null),i=a(null),g=a(null),m=l({userConfigInfo:r((()=>t.getters.getUserConfigInfo)).value,logoutStatus:r((()=>t.getters.getUserLoggingStatus)),uploadedImageList:r((()=>t.getters.getUploadedImageList)),toUploadImage:r((()=>t.getters.getToUploadImage)),imageLoading:!1}),p=()=>{m.imageLoading=!1,t.dispatch("TO_UPLOAD_IMAGE_LOGOUT")};return L((()=>m.logoutStatus),((e,t)=>{e||p()})),e(e({},d(m)),{GitHubExternalLinkInput:o,CDNExternalLinkInput:s,toUploadImageCard_dom:i,uploadArea_dom:g,resetUploadInfo:p,uploadImage:()=>{const{token:e,selectedRepos:a,selectedDir:o}=m.userConfigInfo;return e?a?o?void(0!==m.toUploadImage.list.length?m.toUploadImage.list.length!==m.toUploadImage.uploadedNumber?(m.imageLoading=!0,i.value.uploadImage_all(m.userConfigInfo).then((e=>{switch(e){case at.uploaded:case at.allUploaded:m.imageLoading=!1,t.dispatch("TO_UPLOAD_IMAGE_CLEAN_URL");break;case at.uploadFail:m.imageLoading=!1,t.dispatch("TO_UPLOAD_IMAGE_LIST_FAIL")}})).catch((e=>{console.error("upload error: ",e),m.imageLoading=!1}))):C.error("请选择要上传的图片！"):C.error("图片不能为空！")):(C.error("目录不能为空！"),void n.push("/config")):(C.error("请选择一个仓库！"),void n.push("/config")):(C.error("请先完成图床配置！"),void n.push("/config"))}})}});const Bt=h("data-v-007df71a");g("data-v-007df71a");const Ht={class:"upload-page-container"},Xt={key:0,class:"upload-page-left page-container",style:{width:"30%"}},Jt={class:"uploaded-item"},Yt={class:"row-item"},qt={class:"content-box"},Wt={class:"row-item"},Kt={class:"content-box"},Qt={class:"row-item"},Zt={class:"content-box",style:{"text-align":"right"}},ea=_("重置 "),ta=_("上传 ");m();const aa=Bt(((e,t,a,n,l,r)=>{const d=p("ImageCard"),u=p("UploadArea"),c=p("ToUploadImageCard"),g=p("el-button");return o(),s("div",Ht,[e.uploadedImageList.length?(o(),s("div",Xt,[(o(!0),s(v,null,D(e.uploadedImageList,(e=>(o(),s("div",Jt,[i(d,{"image-obj":e,"is-uploaded":!0},null,8,["image-obj"])])))),256))])):I("",!0),i("div",{class:"upload-page-right page-container",style:{width:e.uploadedImageList.length?"70%":"100%"}},[i("div",Yt,[i("div",qt,[i(u,{"image-loading":e.imageLoading,ref:"uploadArea_dom"},null,8,["image-loading"])])]),i("div",Wt,[i("div",Kt,[i(c,{ref:"toUploadImageCard_dom","loading-all-image":e.imageLoading},null,8,["loading-all-image"])])]),i("div",Qt,[i("div",Zt,[e.toUploadImage.list.length?(o(),s(g,{key:0,plain:"",size:"small",onClick:e.resetUploadInfo},{default:Bt((()=>[ea])),_:1},8,["onClick"])):I("",!0),i(g,{type:"primary",plain:"",size:"small",onClick:e.uploadImage},{default:Bt((()=>[ta])),_:1},8,["onClick"])])])],4)])}));Ft.render=aa,Ft.__scopeId="data-v-007df71a";var na=t({name:"Management",components:{ImageCard:je,selectedInfoBar:ot},setup(){const t=c(),a=u(),o=l({userConfigInfo:r((()=>t.getters.getUserConfigInfo)).value,loggingStatus:r((()=>t.getters.getUserLoggingStatus)).value,dirImageList:r((()=>t.getters.getDirImageList)).value,currentDirImageList:[],loadingImageList:!1,initDirImageList(){if(!this.dirImageList.length)return void this.getReposContent();const e=this.userConfigInfo.selectedDir,t=this.dirImageList.find((t=>t.dir===e));t?t.imageList.length>0?this.currentDirImageList=t.imageList:this.getDirContent(e):this.isHasDir(e)&&this.getDirContent(e)},getReposContent(){var e,a;ve.get(`/repos/${null==(e=this.userConfigInfo)?void 0:e.owner}/${null==(a=this.userConfigInfo)?void 0:a.selectedRepos}/contents`,{headers:{"Content-Type":"application/json",Authorization:`token ${this.userConfigInfo.token}`}}).then((e=>{if(console.log("res: ",e),e&&200===e.status&&e.data.length>0){t.dispatch("DIR_IMAGE_LIST_ADD_DIR","/");for(const a of e.data)"dir"===a.type?t.dispatch("DIR_IMAGE_LIST_ADD_DIR",a.name):"file"===a.type&&et(Qe(a.name).suffix)&&t.dispatch("DIR_IMAGE_LIST_ADD_IMAGE",this.getImageObject(a,"/"));this.isHasDir(this.userConfigInfo.selectedDir)||(this.userConfigInfo.selectedDir="/"),this.dirChange(this.userConfigInfo.selectedDir)}}))},isHasDir(e){return this.userConfigInfo.dirList.some((t=>t.value===e))},getDirContent(e){var a,n;this.loadingImageList=!0;const o={dir:e,imageList:[]};ve.get(`/repos/${null==(a=this.userConfigInfo)?void 0:a.owner}/${null==(n=this.userConfigInfo)?void 0:n.selectedRepos}/contents/${e}`,{headers:{"Content-Type":"application/json",Authorization:`token ${this.userConfigInfo.token}`}}).then((a=>{if(a&&200===a.status&&a.data.length>0){const n=[];for(const t of a.data)"file"===t.type&&et(Qe(t.name).suffix)&&n.push(this.getImageObject(t,e));o.imageList=n,t.dispatch("DIR_IMAGE_LIST_ADD_IMAGE_LIST",o),this.loadingImageList=!1}}))},getImageObject(e,t){if(et(Qe(e.name).suffix))return{uuid:Ke(),dir:t,name:e.name,path:e.path,sha:e.sha,github_url:tt("github",e,this.userConfigInfo),cdn_url:tt("cdn",e,this.userConfigInfo),markdown_gh:tt("markdown_gh",e,this.userConfigInfo),markdown_cdn:tt("markdown_cdn",e,this.userConfigInfo),deleting:!1}},dirChange(e){const t=this.dirImageList.find((t=>t.dir===e));t&&t.imageList.length?this.currentDirImageList=t.imageList:this.getDirContent(e)}});return n((()=>{o.initDirImageList()})),L((()=>o.loggingStatus),(e=>{!e&&a.push("/config")})),L((()=>o.dirImageList),(e=>{const t=e.find((e=>e.dir===o.userConfigInfo.selectedDir));t&&(o.currentDirImageList=t.imageList)}),{deep:!0}),e(e({},d(o)),{dirChange:function(e){o.dirChange(e)}})}});const oa=h("data-v-f3991570");g("data-v-f3991570");const sa={class:"page-container management-page-container"},ia={class:"content-container"},la={class:"top"},ra={class:"left"},da={class:"right"},ua=_(" 切换目录： "),ca={class:"bottom","element-loading-text":"加载中...","element-loading-background":"rgba(0, 0, 0, 0.6)"},ga={class:"image-list"},ma={class:"image-item",style:{width:"220px",height:"230px"}};m();const pa=oa(((e,t,a,n,l,r)=>{const d=p("selectedInfoBar"),u=p("el-option"),c=p("el-select"),g=p("ImageCard"),m=E("loading");return o(),s("div",sa,[i("div",ia,[i("div",la,[i("div",ra,[i(d)]),i("div",da,[ua,i(c,{modelValue:e.userConfigInfo.selectedDir,"onUpdate:modelValue":t[1]||(t[1]=t=>e.userConfigInfo.selectedDir=t),placeholder:"请选择",size:"mini",onChange:e.dirChange},{default:oa((()=>[(o(!0),s(v,null,D(e.userConfigInfo.dirList,(e=>(o(),s(u,{label:e.label,value:e.value},null,8,["label","value"])))),256))])),_:1},8,["modelValue","onChange"])])]),b(i("div",ca,[i("ul",ga,[(o(!0),s(v,null,D(e.currentDirImageList,(e=>(o(),s("li",ma,[i(g,{"image-obj":e},null,8,["image-obj"])])))),256))])],512),[[m,e.loadingImageList]])])])}));na.render=pa,na.__scopeId="data-v-f3991570";const fa=[{path:"/",name:"Index",redirect:{name:"Upload"}},{path:"/config",name:"Config",component:Se,meta:{title:"图床配置 | PicX 图床神器"}},{path:"/upload",name:"Upload",component:Ft,meta:{title:"图片上传 | PicX 图床神器"}},{path:"/management",name:"Management",component:na,meta:{title:"图床管理 | PicX 图床神器"}},{path:"/help",name:"Help",component:()=>function(e,t){if(!t)return e();if(void 0===Ce){const e=document.createElement("link").relList;Ce=e&&e.supports&&e.supports("modulepreload")?"modulepreload":"preload"}return Promise.all(t.map((e=>{if(e in Le)return;Le[e]=!0;const t=e.endsWith(".css"),a=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${a}`))return;const n=document.createElement("link");return n.rel=t?"stylesheet":Ce,t||(n.as="script",n.crossOrigin=""),n.href=e,document.head.appendChild(n),t?new Promise(((e,t)=>{n.addEventListener("load",e),n.addEventListener("error",t)})):void 0}))).then((()=>e()))}((()=>__import__("./help.7cb62ea3.js")),["./assets/help.7cb62ea3.js","./assets/help.37c53838.css","./assets/vendor.e7a27f28.js"]),meta:{title:"帮助反馈 | PicX 图床神器"}}],Ia=R({history:w(),routes:fa});Ia.beforeEach(((e,t,a)=>{e.meta.title&&(window.document.title=e.meta.title),a()}));const ha=()=>{let e=sessionStorage.getItem("PICX_UPLOADED");return e?JSON.parse(e):[]};const _a=()=>{let e=localStorage.getItem("PICX_MANAGEMENT");return e?JSON.parse(e):[]};const Ca=e=>{const t=Object.prototype.toString.call(e).split(" ")[1];return t.substring(0,t.length-1).toLowerCase()},La=e=>{for(let t in e)switch(Ca(e[t])){case"object":La(e[t]);break;case"string":e[t]="";break;case"array":e[t]=[];break;case"number":e[t]=0;break;case"boolean":e[t]=!1}};var va=T({modules:{toUploadImage:{state:()=>({curImgBase64Url:"",curImgUuid:"",list:[],uploadedNumber:0}),actions:{TO_UPLOAD_IMAGE_LIST_ADD(e,t){e.state.list.unshift(t)},TO_UPLOAD_IMAGE_SET_CURRENT(e,{uuid:t,base64Url:a}){e.state.curImgUuid=t,e.state.curImgBase64Url=a},TO_UPLOAD_IMAGE_UPLOADED(e,t){e.state.uploadedNumber++},TO_UPLOAD_IMAGE_LIST_REMOVE(e,t){if(e.state.list.length>0){const a=e.state.list.findIndex((e=>e.uuid===t));if(-1!==a&&e.state.list.splice(a,1),0===e.state.list.length)e.state.curImgBase64Url="",e.state.uploadedNumber=0;else if(e.state.curImgUuid===t){const t=e.state.list[0];e.state.curImgBase64Url=t.imgData.base64Url,e.state.curImgUuid=t.uuid}}},TO_UPLOAD_IMAGE_LIST_FAIL(e){if(e.state.list.length>0){const t=e.state.list.filter((e=>100!==e.uploadStatus.progress));t.length>0&&(e.state.list=t,e.state.uploadedNumber=0,e.state.curImgBase64Url=t[0].imgData.base64Url)}},TO_UPLOAD_IMAGE_CLEAN_URL(e){e.state.curImgBase64Url=""},TO_UPLOAD_IMAGE_CLEAN_LIST(e){e.state.list=[]},TO_UPLOAD_IMAGE_CLEAN_UPLOADED_NUMBER(e){e.state.uploadedNumber=0},TO_UPLOAD_IMAGE_LOGOUT(e){e.state.curImgBase64Url="",e.state.list=[],e.state.uploadedNumber=0}},getters:{getToUploadImageList:e=>e.list,getToUploadImage:e=>e}},uploadedImageList:{state:()=>({uploadedImageList:ha()}),mutations:{},actions:{UPLOADED_LIST_ADD(e,t){e.state.uploadedImageList.unshift(t),e.dispatch("UPLOADED_LIST_PERSIST")},UPLOADED_LIST_REMOVE(e,t){if(e.state.uploadedImageList.length>0){const a=e.state.uploadedImageList.findIndex((e=>e.uuid===t.uuid));-1!==a&&(e.state.uploadedImageList.splice(a,1),e.dispatch("UPLOADED_LIST_PERSIST"))}},UPLOADED_LIST_PERSIST(e){sessionStorage.setItem("PICX_UPLOADED",JSON.stringify(e.state.uploadedImageList))},UPLOADED_LIST_LOGOUT(e){e.state.uploadedImageList=[],sessionStorage.removeItem("PICX_UPLOADED")}},getters:{getUploadedImageList:e=>e.uploadedImageList}},dirImageList:{state:()=>({dirImageList:_a()}),mutations:{},actions:{DIR_IMAGE_LIST_ADD_IMAGE(e,t){const a=e.state.dirImageList.find((e=>e.dir===t.dir));a&&(a.imageList.push(t),e.dispatch("DIR_IMAGE_LIST_PERSIST"))},DIR_IMAGE_LIST_ADD_IMAGE_LIST(e,t){const a=e.state.dirImageList.find((e=>e.dir===t.dir));a?a.imageList=t.imageList:e.state.dirImageList.unshift(t),e.dispatch("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_ADD_DIR(e,t){if(!e.state.dirImageList.some((e=>e.dir===t))){const a={dir:t,imageList:[]};"/"===t?e.state.dirImageList.unshift(a):e.state.dirImageList.push(a),e.dispatch("DIR_IMAGE_LIST_PERSIST")}},DIR_IMAGE_LIST_REMOVE_DIR(e,t){if(e.state.dirImageList.some((e=>e.dir===t))){const a=e.state.dirImageList.findIndex((e=>e.dir===t));e.state.dirImageList.splice(a,1),e.dispatch("DIR_IMAGE_LIST_PERSIST")}},DIR_IMAGE_LIST_REMOVE(e,t){if(e.state.dirImageList.length>0){const a=e.state.dirImageList.find((e=>e.dir===t.dir));if(a){const n=a.imageList.findIndex((e=>e.uuid===t.uuid));-1!==n&&(a.imageList.splice(n,1),0===a.imageList.length&&(e.dispatch("DIR_IMAGE_LIST_REMOVE_DIR",a.dir),e.dispatch("USER_CONFIG_INFO_REMOVE_DIR",a.dir)),e.dispatch("DIR_IMAGE_LIST_PERSIST"))}}},DIR_IMAGE_LIST_PERSIST(e){localStorage.setItem("PICX_MANAGEMENT",JSON.stringify(e.state.dirImageList))},DIR_IMAGE_LOGOUT(e){e.state.dirImageList=[],localStorage.removeItem("PICX_MANAGEMENT")}},getters:{getDirImageList:e=>e.dirImageList}},userConfigInfo:{state:()=>(()=>{let e=localStorage.getItem("PICX_CONFIG");return e?JSON.parse(e):{token:"",owner:"",email:"",name:"",avatarUrl:"",selectedRepos:"",reposList:[],selectedBranch:"",dirMode:"",selectedDir:"",dirList:[],loggingStatus:!1}})(),actions:{SET_USER_CONFIG_INFO(e,t){for(const a in t)e.state.hasOwnProperty(a)&&(e.state[a]=t[a])},USER_CONFIG_INFO_ADD_DIR(e,t){e.state.dirList.some((e=>e.value===t))||(e.state.dirList.push({label:t,value:t}),e.dispatch("USER_CONFIG_INFO_PERSIST"))},USER_CONFIG_INFO_REMOVE_DIR(e,t){const a=e.state.dirList;if(a.some((e=>e.value===t))){const n=a.findIndex((e=>e.value===t));a.splice(n,1),e.dispatch("USER_CONFIG_INFO_PERSIST")}},USER_CONFIG_INFO_PERSIST(e){e.state.selectedDir=e.state.selectedDir.replace(/\s+/g,"-"),localStorage.setItem("PICX_CONFIG",JSON.stringify(e.state))},USER_CONFIG_INFO_LOGOUT(e){La(e.state),localStorage.removeItem("PICX_CONFIG")}},getters:{getUserLoggingStatus:e=>e.loggingStatus,getUserConfigInfo:e=>e}}},state:()=>({imageViewer:{url:"",isShow:!1},uploadAreaActive:!1,uploadSettings:{isSetMaxSize:!1,compressSize:200}}),mutations:{IMAGE_VIEWER(e,{url:t,isShow:a}){e.imageViewer.url=t,e.imageViewer.isShow=a},CHANGE_UPLOAD_AREA_ACTIVE(e,t){e.uploadAreaActive=t}},actions:{LOGOUT({state:e,dispatch:t}){e.uploadAreaActive=!1,e.imageViewer.isShow=!1,e.imageViewer.url="",t("DIR_IMAGE_LOGOUT"),t("TO_UPLOAD_IMAGE_LOGOUT"),t("UPLOADED_LIST_LOGOUT"),t("USER_CONFIG_INFO_LOGOUT")}},getters:{getImageViewer:e=>e.imageViewer,getUploadAreaActive:e=>e.uploadAreaActive,getUploadSettings:e=>e.uploadSettings}});y(_e).use(Ia).use(va).use(M).mount("#app");
