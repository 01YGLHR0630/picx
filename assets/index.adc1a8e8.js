var e=Object.defineProperty,t=Object.prototype.hasOwnProperty,a=Object.getOwnPropertySymbols,s=Object.prototype.propertyIsEnumerable,n=(t,a,s)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,o=(e,o)=>{for(var i in o||(o={}))t.call(o,i)&&n(e,i,o[i]);if(a)for(var i of a(o))s.call(o,i)&&n(e,i,o[i]);return e};import{d as i,r as l,o as r,a as d,c as u,b as c,e as g,f as p,t as m,u as f,g as I,p as h,h as _,i as C,j as v,k as L,w as D,l as b,_ as U,m as S,F as k,n as A,q as E,v as O,s as w,x as y,y as R,z as T,A as M,B as P,C as x,D as G,E as N,G as V,H as $,I as j,J as z,K as F,L as X,M as B,N as H,O as Y,P as J,Q as q,R as W,S as K,T as Q,U as Z,V as ee,W as te,X as ae,Y as se,Z as ne,$ as oe}from"./vendor.cb341a13.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(a){const s=new URL(e,location),n=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((a,o)=>{const i=new URL(e,s);if(self[t].moduleMap[i])return a(self[t].moduleMap[i]);const l=new Blob([`import * as m from '${i}';`,`${t}.moduleMap['${i}']=m;`],{type:"text/javascript"}),r=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(l),onerror(){o(new Error(`Failed to import: ${e}`)),n(r)},onload(){a(self[t].moduleMap[i]),n(r)}});document.head.appendChild(r)})),self[t].moduleMap={}}}("assets/");var ie=i({name:"site-count",props:{isuv:{type:Boolean,default:!1}},setup(){const e=l(null);return r((()=>{const t=document.createElement("script");t.async=!0,t.src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",e.value.appendChild(t)})),{siteCountDom:e}}});const le={class:"site-count",ref:"siteCountDom"},re={key:0,id:"busuanzi_value_site_uv"},de={key:1,id:"busuanzi_value_site_pv"};ie.render=function(e,t,a,s,n,o){return d(),u("span",le,[e.isuv?(d(),u("span",re)):c("",!0),e.isuv?c("",!0):(d(),u("span",de))],512)};var ue=i({name:"Header",components:{siteCount:ie},setup(){const e=f(),t=I(),a=g({defaultUsername:"未登录",userConfigInfo:p((()=>t.state.userConfigInfo))});return o(o({},m(a)),{router:e,onUserInfoClick:()=>{a.userConfigInfo.loggingStatus||"/config"===e.currentRoute.value.path||e.push("/config")},handleCommand:a=>{switch(a){case"upload":e.push("/");break;case"config":e.push("/config");break;case"management":e.push("/management");break;case"logout":t.dispatch("LOGOUT"),e.push("/config")}},goGitHubRepo:()=>{window.open("https://github.com/XPoet/picx")}})}});const ce=D();h("data-v-c2cf1554");const ge={class:"header"},pe={class:"header-left"},me=v("div",{class:"logo"},[v("img",{src:"./assets/logo.206d082d.png",alt:"PicX"})],-1),fe=v("div",{class:"title"},"PicX",-1),Ie={class:""},he=b(" 有 "),_e=b(" 位小伙伴使用 PicX 图床神器"),Ce={class:"header-right"},ve={class:"username"},Le={key:0,class:"avatar"},De=v("i",{class:"el-icon-user-solid"},null,-1),be={class:"el-dropdown-link"},Ue={class:"avatar"},Se=b(" 退出登录 ");_();const ke=ce(((e,t,a,s,n,o)=>{var i,l;const r=C("siteCount"),g=C("el-tooltip"),p=C("el-dropdown-item"),m=C("el-dropdown-menu"),f=C("el-dropdown");return d(),u("header",ge,[v("div",pe,[v("div",{class:"brand",onClick:t[1]||(t[1]=t=>e.router.push("/"))},[me,fe]),v("div",{class:"website-count",onClick:t[2]||(t[2]=(...t)=>e.goGitHubRepo&&e.goGitHubRepo(...t))},[v(g,{effect:"light",content:"点个 Star 支持一下作者吧(*￣︶￣)",placement:"bottom"},{default:ce((()=>[v("i",Ie,[he,v(r,{isuv:!1}),_e])])),_:1})])]),v("div",Ce,[v("div",{class:"user-info",onClick:t[3]||(t[3]=(...t)=>e.onUserInfoClick&&e.onUserInfoClick(...t))},[v("div",ve,L(e.userConfigInfo.owner?e.userConfigInfo.owner:e.defaultUsername),1),(null==(i=e.userConfigInfo)?void 0:i.avatarUrl)?c("",!0):(d(),u("div",Le,[De])),(null==(l=e.userConfigInfo)?void 0:l.avatarUrl)?(d(),u(f,{key:1,trigger:"click",onCommand:e.handleCommand},{dropdown:ce((()=>[v(m,null,{default:ce((()=>[v(p,{command:"logout"},{default:ce((()=>[Se])),_:1})])),_:1})])),default:ce((()=>{var t,a;return[v("span",be,[v("span",Ue,[v("img",{src:null==(t=e.userConfigInfo)?void 0:t.avatarUrl,alt:null==(a=e.userConfigInfo)?void 0:a.owner},null,8,["src","alt"])])])]})),_:1},8,["onCommand"])):c("",!0)])])])}));ue.render=ke,ue.__scopeId="data-v-c2cf1554";var Ae=i({name:"Nav",setup(){const e=f(),t=I(),a=g({userConfigInfo:p((()=>t.getters.getUserConfigInfo)).value,navList:[{name:"图床配置",icon:"el-icon-edit-outline",isActive:!1,path:"/config"},{name:"上传图片",icon:"el-icon-upload2",isActive:!1,path:"/upload"},{name:"图床管理",icon:"el-icon-box",isActive:!1,path:"/management"},{name:"使用教程",icon:"el-icon-magic-stick",isActive:!1,path:"/tutorials"},{name:"帮助反馈",icon:"el-icon-chat-dot-round",isActive:!1,path:"/about"}],navClick(t){const a=t.path;if("/management"===a){if(""===this.userConfigInfo.selectedRepos)return U.warning("请选择一个仓库！"),void e.push("/config");if(""===this.userConfigInfo.selectedDir)return U.warning("目录不能为空！"),void e.push("/config")}e.push(a)}}),s=e=>{a.navList.forEach((t=>t.isActive=t.path===e))};return S((()=>e.currentRoute.value),((e,t)=>{s(e.path)})),r((()=>{e.isReady().then((()=>{s(e.currentRoute.value.path)}))})),o({},m(a))}});const Ee=D();h("data-v-4fcbf4d4");const Oe={class:"nav"},we={class:"nav-list"},ye={class:"nav-content"},Re={class:"nav-name"};_();const Te=Ee(((e,t,a,s,n,o)=>(d(),u("aside",Oe,[v("ul",we,[(d(!0),u(k,null,A(e.navList,(t=>E((d(),u("li",{class:["nav-item flex-center",{active:t.isActive}],onClick:a=>e.navClick(t)},[v("div",ye,[v("i",{class:["nav-icon",t.icon]},null,2),v("span",Re,L(t.name),1)])],10,["onClick"])),[[O,"/management"!==t.path||e.userConfigInfo.loggingStatus]]))),256))])]))));Ae.render=Te,Ae.__scopeId="data-v-4fcbf4d4",h("data-v-0529197a");const Me={key:0,class:"image-box"};_();var Pe=i({expose:[],setup(e){const t=I(),a=p((()=>t.getters.getImageViewer));return(e,t)=>(d(),u("div",{class:["image-viewer",{active:w(a).isShow}],onClick:t[1]||(t[1]=e=>w(a).isShow=!1)},[w(a).url?(d(),u("div",Me,[v("img",{class:"img",src:w(a).url},null,8,["src"])])):c("",!0)],2))}});Pe.__scopeId="data-v-0529197a",h("data-v-3897aef6");const xe={class:"top"},Ge={class:"bottom"},Ne={class:"left"},Ve={class:"right"},$e={class:"content"};_();var je=i({expose:[],setup(e){const t=I(),a=e=>{t.commit("CHANGE_UPLOAD_AREA_ACTIVE",e.target.classList.contains("active-upload"))};return(e,t)=>{const s=C("router-view");return d(),u(k,null,[v("main",{class:"main-container",onClick:a},[v("div",xe,[v(ue)]),v("div",Ge,[v("div",Ne,[v(Ae)]),v("div",Ve,[v("div",$e,[v(s)])])])]),v(Pe)],64)}}});je.__scopeId="data-v-3897aef6";var ze=i({name:"App",components:{Main:je}});let Fe;ze.render=function(e,t,a,s,n,o){const i=C("Main");return d(),u(i)};const Xe={},Be=y.create({baseURL:"https://api.github.com",timeout:3e5});Be.interceptors.request.use((e=>{const t=window.localStorage.getItem("accessToken");return t&&(e.headers.common.Authorization=t),e}),(e=>Promise.reject(e))),Be.interceptors.response.use((e=>e),(e=>{if(e.response&&e.response.data){const t=e.response.status,a=e.response.data.message;U.error(`Code: ${t}, Message: ${a}`),console.error("[PicX Error]",e.response)}else U.error(`${e}`);return e.response}));class He{static zerofill(e){return e<10?"0"+e:e}static getYyyyMmDd(e=Date.now()){const t=new Date(e),a=t.getFullYear(),s=t.getMonth()+1,n=t.getDate();return`${a}${this.zerofill(s)}${this.zerofill(n)}`}static formatTimestamp(e=Date.now()){const t=new Date(e);let a=t.getFullYear(),s=t.getMonth()+1,n=t.getDate(),o=t.getHours(),i=t.getMinutes(),l=t.getSeconds();return`${a}-${this.zerofill(s)}-${this.zerofill(n)} ${this.zerofill(o)}:${this.zerofill(i)}:${this.zerofill(l)}`}}var Ye,Je;(Je=Ye||(Ye={})).autoDir="autoDir",Je.newDir="newDir",Je.rootDir="rootDir",Je.reposDir="reposDir";var qe=i({name:"Config",setup(){const e=f(),t=I(),a=g({userConfigInfo:p((()=>t.getters.getUserConfigInfo)).value,loggingStatus:p((()=>t.getters.getUserConfigInfo)).value,loading:!1,dirLoading:!1,getUserInfo(){this.userConfigInfo.token?(this.loading=!0,Be.get("/user",{headers:{"Content-Type":"application/json",Authorization:`token ${this.userConfigInfo.token}`}}).then((e=>{e&&200===e.status?(this.saveUserInfo(e),this.getReposList(e.data.repos_url)):this.loading=!1}))):U.warning("Token 不能为空！")},saveUserInfo(e){this.userConfigInfo.loggingStatus=!0,this.userConfigInfo.owner=e.data.login,this.userConfigInfo.name=e.data.name,this.userConfigInfo.email=e.data.email,this.userConfigInfo.avatarUrl=e.data.avatar_url,this.persistUserConfigInfo()},getReposList(e){Be.get(e,{headers:{"Content-Type":"application/json",Authorization:`token ${this.userConfigInfo.token}`}}).then((e=>{if(200===e.status&&e.data.length>0){this.userConfigInfo.reposList=[];for(const t of e.data)t.fork||this.userConfigInfo.reposList.push({value:t.name,label:t.name,desc:t.description});this.loading=!1,this.persistUserConfigInfo()}}))},innerSelectRepos(e){a.getBranchList(e),a.persistUserConfigInfo()},getBranchList(e){this.dirLoading=!0,Be.get(`/repos/${this.userConfigInfo.owner}/${e}/branches`,{headers:{"Content-Type":"application/json",Authorization:`token ${this.userConfigInfo.token}`}}).then((t=>{if(t&&200===t.status){this.dirLoading=!1;const a="master",s="main";t.data.length>0?(t.data.some((e=>e.name===a))?this.userConfigInfo.selectedBranch=a:t.data.some((e=>e.name===s))&&(this.userConfigInfo.selectedBranch=s),this.getDirList(e)):(this.userConfigInfo.selectedBranch=a,this.userConfigInfo.dirMode=Ye.newDir,this.userConfigInfo.selectedDir="",this.userConfigInfo.dirList=[])}}))},getDirList(e){this.dirLoading=!0,Be.get(`/repos/${this.userConfigInfo.owner}/${e}/contents`,{headers:{"Content-Type":"application/json",Authorization:`token ${this.userConfigInfo.token}`}}).then((e=>{if(e&&200===e.status&&e.data.length>0){this.userConfigInfo.dirList=[{value:"/",label:"/"}];for(const t of e.data)"dir"===t.type&&this.userConfigInfo.dirList.push({value:t.name,label:t.name});this.persistUserConfigInfo()}this.dirLoading=!1}))},innerDirModeChange(e){switch(e){case Ye.rootDir:this.userConfigInfo.selectedDir="/";break;case Ye.autoDir:this.userConfigInfo.selectedDir=He.getYyyyMmDd();break;case Ye.newDir:case Ye.reposDir:this.userConfigInfo.selectedDir=""}this.persistUserConfigInfo()},persistUserConfigInfo(){t.dispatch("USER_CONFIG_INFO_PERSIST")},reset(){this.loading=!1,this.dirLoading=!1,t.dispatch("LOGOUT")},innerGoUpload(){const t=this.userConfigInfo.selectedDir,a=this.userConfigInfo.dirMode;let s="目录不能为空！";if(""!==t)e.push("/upload");else{switch(a){case Ye.newDir:s="请在输入框输入一个新目录！";break;case Ye.reposDir:s=`请选择 ${this.userConfigInfo.selectedRepos} 仓库下的一个目录！`}U.warning(s)}}});return S((()=>a.loggingStatus),((e,t)=>{e||(a.loading=!1,a.dirLoading=!1)})),o(o({},m(a)),{dirModeChange:e=>{a.innerDirModeChange(e)},selectRepos:e=>{a.innerSelectRepos(e)},goUpload:()=>{a.innerGoUpload()}})}});const We=D();h("data-v-c6159394");const Ke={class:"page-container config-page-container"},Qe=b(" 确认 Token "),Ze=b("新建目录"),et=b("根目录"),tt=b("自动目录"),at=b(" 重置 "),st=b("完成配置 ");_();const nt=We(((e,t,a,s,n,o)=>{const i=C("el-input"),l=C("el-form-item"),r=C("el-button"),g=C("el-form"),p=C("el-option"),m=C("el-select"),f=C("el-radio"),I=C("el-tooltip"),h=C("el-radio-group"),_=R("loading");return d(),u("div",Ke,[v(g,{"label-width":"70px","label-position":"right",class:"config-form"},{default:We((()=>[v(l,{label:"Token"},{default:We((()=>[v(i,{modelValue:e.userConfigInfo.token,"onUpdate:modelValue":t[1]||(t[1]=t=>e.userConfigInfo.token=t),clearable:!0},null,8,["modelValue"])])),_:1}),v(l,{class:"operation"},{default:We((()=>[v(r,{plain:"",size:"small",type:"primary",onClick:t[2]||(t[2]=t=>e.getUserInfo())},{default:We((()=>[Qe])),_:1})])),_:1})])),_:1}),e.userConfigInfo.token?E((d(),u(g,{key:0,"label-width":"70px","label-position":"right","element-loading-text":"加载中..."},{default:We((()=>[e.userConfigInfo.owner?(d(),u(l,{key:0,label:"用户名"},{default:We((()=>[v(i,{modelValue:e.userConfigInfo.owner,"onUpdate:modelValue":t[3]||(t[3]=t=>e.userConfigInfo.owner=t),readonly:""},null,8,["modelValue"])])),_:1})):c("",!0),e.userConfigInfo.email?(d(),u(l,{key:1,label:"邮箱"},{default:We((()=>[v(i,{modelValue:e.userConfigInfo.email,"onUpdate:modelValue":t[4]||(t[4]=t=>e.userConfigInfo.email=t),readonly:""},null,8,["modelValue"])])),_:1})):c("",!0),e.userConfigInfo.reposList.length?(d(),u(l,{key:2,label:"选择仓库"},{default:We((()=>[v(m,{modelValue:e.userConfigInfo.selectedRepos,"onUpdate:modelValue":t[5]||(t[5]=t=>e.userConfigInfo.selectedRepos=t),filterable:"",style:{width:"100%"},placeholder:"请选择图床仓库...",onChange:e.selectRepos},{default:We((()=>[(d(!0),u(k,null,A(e.userConfigInfo.reposList,((e,t)=>(d(),u(p,{key:t+"_"+e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1})):c("",!0)])),_:1},512)),[[_,e.loading]]):c("",!0),e.userConfigInfo.selectedRepos?E((d(),u(g,{key:1,"label-width":"70px","label-position":"right","element-loading-text":"加载中..."},{default:We((()=>[e.userConfigInfo.reposList.length&&e.userConfigInfo.selectedRepos?(d(),u(l,{key:0,label:"目录方式"},{default:We((()=>[v(h,{modelValue:e.userConfigInfo.dirMode,"onUpdate:modelValue":t[6]||(t[6]=t=>e.userConfigInfo.dirMode=t),onChange:e.dirModeChange},{default:We((()=>[v(I,{content:"手动输入一个新目录",placement:"top"},{default:We((()=>[v(f,{label:"newDir"},{default:We((()=>[Ze])),_:1})])),_:1}),v(I,{content:"图片存储在 "+e.userConfigInfo.selectedBranch+" 分支的根目录下",placement:"top"},{default:We((()=>[v(f,{label:"rootDir"},{default:We((()=>[et])),_:1})])),_:1},8,["content"]),v(I,{content:"根据日期自动创建格式 YYYYMMDD 的目录",placement:"top"},{default:We((()=>[v(f,{label:"autoDir"},{default:We((()=>[tt])),_:1})])),_:1}),e.userConfigInfo.dirList.length?(d(),u(I,{key:0,content:"选择 "+e.userConfigInfo.selectedRepos+" 仓库下的一个目录",placement:"top"},{default:We((()=>[v(f,{label:"reposDir"},{default:We((()=>[b("选择 "+L(e.userConfigInfo.selectedRepos)+" 仓库目录",1)])),_:1})])),_:1},8,["content"])):c("",!0)])),_:1},8,["modelValue","onChange"])])),_:1})):c("",!0),"autoDir"===e.userConfigInfo.dirMode?(d(),u(l,{key:1,label:"自动目录"},{default:We((()=>[v(i,{modelValue:e.userConfigInfo.selectedDir,"onUpdate:modelValue":t[7]||(t[7]=t=>e.userConfigInfo.selectedDir=t),readonly:""},null,8,["modelValue"])])),_:1})):c("",!0),"rootDir"===e.userConfigInfo.dirMode?(d(),u(l,{key:2,label:"根目录"},{default:We((()=>[v(i,{modelValue:e.userConfigInfo.selectedDir,"onUpdate:modelValue":t[8]||(t[8]=t=>e.userConfigInfo.selectedDir=t),readonly:""},null,8,["modelValue"])])),_:1})):c("",!0),"newDir"===e.userConfigInfo.dirMode?(d(),u(l,{key:3,label:"新建目录"},{default:We((()=>[v(i,{modelValue:e.userConfigInfo.selectedDir,"onUpdate:modelValue":t[9]||(t[9]=t=>e.userConfigInfo.selectedDir=t),onInput:t[10]||(t[10]=t=>e.persistUserConfigInfo()),clearable:"",placeholder:"请输入新建的目录..."},null,8,["modelValue"])])),_:1})):c("",!0),e.userConfigInfo.dirList.length&&"reposDir"===e.userConfigInfo.dirMode?(d(),u(l,{key:4,label:"选择目录"},{default:We((()=>[v(m,{modelValue:e.userConfigInfo.selectedDir,"onUpdate:modelValue":t[11]||(t[11]=t=>e.userConfigInfo.selectedDir=t),filterable:"",style:{width:"100%"},placeholder:"请选择目录...",onChange:e.persistUserConfigInfo},{default:We((()=>[(d(!0),u(k,null,A(e.userConfigInfo.dirList,(e=>(d(),u(p,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1})):c("",!0)])),_:1},512)),[[_,e.dirLoading]]):c("",!0),v(g,{"label-width":"70px"},{default:We((()=>[v(l,{class:"operation"},{default:We((()=>[e.userConfigInfo.owner?(d(),u(r,{key:0,plain:"",size:"small",onClick:t[12]||(t[12]=t=>e.reset())},{default:We((()=>[at])),_:1})):c("",!0),e.userConfigInfo.selectedRepos?(d(),u(r,{key:1,plain:"",size:"small",type:"success",onClick:e.goUpload},{default:We((()=>[st])),_:1},8,["onClick"])):c("",!0)])),_:1})])),_:1})])}));var ot,it;qe.render=nt,qe.__scopeId="data-v-c6159394",(it=ot||(ot={})).gh="gh",it.md_gh="md_gh",it.cdn="cdn",it.md_cdn="md_cdn";var lt=i({name:"copy-external-link",props:{imgObj:{type:Object,default:()=>({})}},setup:e=>({copyExternalLink:function(t){let a="",s="";switch(t){case ot.gh:e.imgObj.is_transform_md?(a=e.imgObj.md_gh_url,s="Markdown 格式的 GitHub"):(a=e.imgObj.github_url,s="GitHub");break;case ot.cdn:e.imgObj.is_transform_md?(a=e.imgObj.md_cdn_url,s="Markdown 格式的 CDN"):(a=e.imgObj.cdn_url,s="CDN")}let n=document.querySelector(".temp-external-link");n||(n=document.createElement("textarea"),n.setAttribute("class","temp-external-link"),n.style.position="absolute",n.style.top="-99999px",n.style.left="-99999px",document.body.appendChild(n)),n.value=a,n.select(),document.execCommand("copy"),U.success(`${s} 外链复制成功！`)},transformMD:function(){e.imgObj.is_transform_md=!e.imgObj.is_transform_md},externalLinkType:ot})});const rt=D();h("data-v-157df113");const dt={class:"copy-external-link-box"};_();const ut=rt(((e,t,a,s,n,o)=>{const i=C("el-tooltip");return d(),u("div",dt,[v(i,{content:e.imgObj.is_transform_md?"已转换 Markdown 格式":"转换 Markdown 格式",placement:"top"},{default:rt((()=>[v("span",{class:["btn-item transform-btn",{"is-transform":e.imgObj.is_transform_md}],onClick:t[1]||(t[1]=t=>e.transformMD())}," MD ",2)])),_:1},8,["content"]),v(i,{content:"点击复制 GitHub 外链",placement:"top"},{default:rt((()=>[v("span",{class:"btn-item copy-url",onClick:t[2]||(t[2]=t=>e.copyExternalLink(e.externalLinkType.gh))}," GitHub ")])),_:1}),v(i,{content:"点击复制 CDN 外链",placement:"top"},{default:rt((()=>[v("span",{class:"btn-item copy-url",onClick:t[3]||(t[3]=t=>e.copyExternalLink(e.externalLinkType.cdn))}," CDN ")])),_:1})])}));lt.render=ut,lt.__scopeId="data-v-157df113";var ct=i({name:"ImageCard",components:{copyExternalLink:lt},props:{imageObj:{type:Object,default:()=>{}},isUploaded:{type:Boolean,default:!1}},setup(){const e=I(),t=g({isEnableDeleted:!0,userConfigInfo:p((()=>e.getters.getUserConfigInfo)).value,deleteImage(t){var a,s,n,o,i;t.deleting=!0,Be.delete(`/repos/${null==(a=this.userConfigInfo)?void 0:a.owner}/${null==(s=this.userConfigInfo)?void 0:s.selectedRepos}/contents/${t.path}`,{headers:{"Content-Type":"application/json",Authorization:`token ${null==(n=this.userConfigInfo)?void 0:n.token}`},data:{owner:null==(o=this.userConfigInfo)?void 0:o.owner,repo:null==(i=this.userConfigInfo)?void 0:i.selectedRepos,path:t.path,message:"delete pictures via PicX(https://github.com/XPoet/picx)",sha:t.sha}}).then((a=>{console.log("delete res: ",a),a&&200===a.status?(t.deleting=!1,U.success("删除成功！"),e.dispatch("UPLOADED_LIST_REMOVE",t),e.dispatch("DIR_IMAGE_LIST_REMOVE",t)):t.deleting=!1}))},imageView(t){e.commit("IMAGE_VIEWER",{isShow:!0,url:t.cdn_url})}});return o({},m(t))}});const gt=D();h("data-v-ba5f8936");const pt={class:"image-card","element-loading-text":"删除中...","element-loading-background":"rgba(0, 0, 0, 0.6)"},mt={class:"image-box"},ft={class:"info-box"},It={class:"image-info"},ht={class:"filename"},_t={class:"image-operation"},Ct={class:"delete"};_();const vt=gt(((e,t,a,s,n,o)=>{const i=C("el-tooltip"),l=C("copyExternalLink"),r=R("loading");return E((d(),u("div",pt,[v("div",mt,[v("img",{src:e.imageObj.cdn_url,onClick:t[1]||(t[1]=t=>e.imageView(e.imageObj))},null,8,["src"])]),v("div",ft,[v("div",It,[v("div",ht,L(e.imageObj.name),1),v("div",_t,[v("div",Ct,[v(i,{content:"删除",placement:"top"},{default:gt((()=>[v("i",{class:"el-icon-delete",onClick:t[2]||(t[2]=t=>e.deleteImage(e.imageObj))})])),_:1})]),v("div",null,[v(l,{"img-obj":e.imageObj},null,8,["img-obj"])])])])])],512)),[[r,e.imageObj.deleting]])}));ct.render=vt,ct.__scopeId="data-v-ba5f8936";const Lt=()=>Number(Math.random().toString().substr(2,5)+Date.now()).toString(36),Dt=e=>{const t=e.lastIndexOf("."),a=e.substr(0,t),s=e.substr(t+1,e.length);return{name:a,hash:Lt(),suffix:s}},bt=e=>{const t=e.indexOf(".");return e.substr(0,t)},Ut=e=>/(png|jpg|gif|jpeg|webp|svg\+xml)$/.test(e),St=(e,t,a)=>{const s=`https://cdn.jsdelivr.net/gh/${a.owner}/${a.selectedRepos}@${a.selectedBranch}/${t.path}`,n=decodeURI(t.download_url);switch(e){case ot.gh:return n;case ot.md_gh:return`![${bt(t.name)}](${n})`;case ot.cdn:return s;case ot.md_cdn:return`![${bt(t.name)}](${s})`}};var kt,At;(At=kt||(kt={})).waitUpload="waitUpload",At.uploading="uploading",At.uploaded="uploaded",At.allUploaded="allUploaded",At.uploadFail="uploadFail";var Et=i({name:"selected-info-bar",setup(){const e=I(),t=g({userConfigInfo:p((()=>e.getters.getUserConfigInfo))});return o({},m(t))}});const Ot=D();h("data-v-06339d16");const wt={key:0,class:"selected-info-bar-box"},yt={class:"info-item"},Rt=b(" 仓库："),Tt={key:0,class:"info-item"},Mt=b(" 分支："),Pt={key:1,class:"info-item"},xt=b(" 目录：");_();const Gt=Ot(((e,t,a,s,n,o)=>{const i=C("el-tag");return e.userConfigInfo.selectedRepos?(d(),u("div",wt,[v("span",yt,[Rt,v(i,{size:"mini"},{default:Ot((()=>[b(L(e.userConfigInfo.selectedRepos),1)])),_:1})]),e.userConfigInfo.selectedBranch?(d(),u("span",Tt,[Mt,v(i,{size:"mini"},{default:Ot((()=>[b(L(e.userConfigInfo.selectedBranch),1)])),_:1})])):c("",!0),e.userConfigInfo.selectedDir?(d(),u("span",Pt,[xt,v(i,{size:"mini"},{default:Ot((()=>[b(L(e.userConfigInfo.selectedDir),1)])),_:1})])):c("",!0)])):c("",!0)}));Et.render=Gt,Et.__scopeId="data-v-06339d16";var Nt=i({name:"to-upload-image-card",components:{copyExternalLink:lt,selectedInfoBar:Et},props:{loadingAllImage:{type:Boolean,default:!1}},setup(){const e=I(),t=g({userConfigInfo:p((()=>e.getters.getUserConfigInfo)).value,toUploadImage:p((()=>e.getters.getToUploadImage)),hashRename(e,t){t.filename.now=e?`${t.filename.name}.${t.filename.hash}.${t.filename.suffix}`:`${t.filename.name}.${t.filename.suffix}`},rename(e,t){t.filename.name=e?t.filename.newName:t.filename.initName,t.filename.isHashRename?t.filename.now=`${t.filename.name}.${t.filename.hash}.${t.filename.suffix}`:t.filename.now=`${t.filename.name}.${t.filename.suffix}`},getFileSize:e=>(e=>(e/1024).toFixed(2)+" KB")(e),formatLastModified:e=>He.formatTimestamp(e),async uploadImage_all(e){const t=this.toUploadImage.uploadedNumber;return t>=this.toUploadImage.list.length?kt.uploaded:!0===await this.uploadImage_single(e,this.toUploadImage.list[t])?t<this.toUploadImage.list.length?(await this.uploadImage_all(e),kt.allUploaded):kt.uploaded:kt.uploadFail},uploadImage_single(t,a){const{token:s,selectedBranch:n,email:o,owner:i}=t;a.uploadStatus.uploading=!0;const l={message:"Upload pictures via PicX(https://github.com/XPoet/picx)",branch:n,content:a.imgData.base64Content};return o&&(l.committer={name:i,email:o}),new Promise(((n,o)=>{Be.put(((e,t)=>{let a="";return"/"!==e.selectedDir&&(a=e.selectedDir+"/"),`/repos/${e.owner}/${e.selectedRepos}/contents/${a}${t}`})(t,a.filename.now),l,{headers:{"Content-Type":"application/json",Authorization:`token ${s}`}}).then((s=>{s&&201===s.status?(this.uploadedHandle(s,a,t),e.dispatch("TO_UPLOAD_IMAGE_UPLOADED",a.uuid),n(!0),U.success("上传成功！")):(a.uploadStatus.uploading=!1,n(!1),U.error("上传失败！"))})).catch((e=>{o(e)}))}))},uploadedHandle(t,a,s){a.uploadStatus.progress=100,a.uploadStatus.uploading=!1,a.externalLink.github=St(ot.gh,t.data.content,s),a.externalLink.cdn=St(ot.cdn,t.data.content,s),a.externalLink.markdown_gh=St(ot.md_gh,t.data.content,s),a.externalLink.markdown_cdn=St(ot.md_cdn,t.data.content,s);const n={uuid:a.uuid,dir:s.selectedDir,name:t.data.content.name,path:t.data.content.path,sha:t.data.content.sha,github_url:a.externalLink.github,cdn_url:a.externalLink.cdn,md_gh_url:a.externalLink.markdown_gh,md_cdn_url:a.externalLink.markdown_cdn,is_transform_md:!1,deleting:!1};a.uploadedImg=n,s.dirList.some((e=>e.value===n.dir))||(e.dispatch("USER_CONFIG_INFO_ADD_DIR",n.dir),e.dispatch("DIR_IMAGE_LIST_ADD_DIR",n.dir)),e.dispatch("UPLOADED_LIST_ADD",n),e.dispatch("DIR_IMAGE_LIST_ADD_IMAGE",n)},imageViewer(t){e.commit("IMAGE_VIEWER",{isShow:!0,url:t})}});return o(o({},m(t)),{removeToUploadImage:t=>{e.dispatch("TO_UPLOAD_IMAGE_LIST_REMOVE",t.uuid)}})}});const Vt={key:0,class:"to-upload-image-list-card"},$t={class:"header"},jt={key:0},zt={key:0,class:"body"},Ft={class:"image-uploading-info-box"},Xt={class:"left-image-box flex-center"},Bt={class:"right-operation-box"},Ht={class:"top"},Yt={class:"image-name"},Jt={class:"image-info"},qt={class:"file-size item"},Wt={class:"last-modified item"},Kt={key:0,class:"bottom rename-operation"},Qt={key:1,class:"bottom rename-operation"},Zt={key:0,class:"el-icon-upload2"},ea={key:1,class:"el-icon-loading"},ta={key:2,class:"el-icon-check"},aa=v("i",{class:"el-icon-delete"},null,-1);function sa(e,t,a){a&&a(e,t)}Nt.render=function(e,t,a,s,n,o){const i=C("selectedInfoBar"),l=C("el-checkbox"),r=C("el-input"),g=C("copyExternalLink"),p=C("el-tooltip");return e.toUploadImage.list.length||e.userConfigInfo.selectedRepos?(d(),u("div",Vt,[v("div",$t,[v("div",null,[v(i)]),v("div",null,[e.toUploadImage.list.length?(d(),u("span",jt,"已上传："+L(e.toUploadImage.uploadedNumber)+" / "+L(e.toUploadImage.list.length),1)):c("",!0)])]),e.toUploadImage.list.length?(d(),u("div",zt,[v("ul",Ft,[(d(!0),u(k,null,A(e.toUploadImage.list,((t,a)=>(d(),u("li",{class:["image-uploading-info-item",{disable:e.loadingAllImage}],key:a},[v("div",Xt,[v("div",{class:"image-box",onClick:a=>e.imageViewer(t.imgData.base64Url)},[v("img",{src:t.imgData.base64Url},null,8,["src"])],8,["onClick"])]),v("div",Bt,[v("div",Ht,[v("div",Yt,L(t.filename.now),1),v("div",Jt,[v("span",qt,L(e.getFileSize(t.fileInfo.size)),1),v("span",Wt,L(e.formatLastModified(t.fileInfo.lastModified)),1)])]),t.uploadStatus.uploading||100===t.uploadStatus.progress?c("",!0):(d(),u("div",Kt,[v(l,{label:"哈希化",modelValue:t.filename.isHashRename,"onUpdate:modelValue":e=>t.filename.isHashRename=e,onChange:a=>e.hashRename(a,t)},null,8,["modelValue","onUpdate:modelValue","onChange"]),v(l,{label:"重命名",modelValue:t.filename.isRename,"onUpdate:modelValue":e=>t.filename.isRename=e,onChange:a=>e.rename(a,t)},null,8,["modelValue","onUpdate:modelValue","onChange"]),t.filename.isRename?(d(),u(r,{key:0,class:"rename-input",size:"mini",modelValue:t.filename.newName,"onUpdate:modelValue":e=>t.filename.newName=e,onInput:a=>e.rename(a,t),clearable:""},null,8,["modelValue","onUpdate:modelValue","onInput"])):c("",!0)])),t.uploadStatus.uploading||100!==t.uploadStatus.progress?c("",!0):(d(),u("div",Qt,[v(g,{"img-obj":t.uploadedImg},null,8,["img-obj"])]))]),v("div",{class:["upload-status-box",{"wait-upload":!t.uploadStatus.uploading&&100!==t.uploadStatus.progress,uploading:t.uploadStatus.uploading&&100!==t.uploadStatus.progress,uploaded:!t.uploadStatus.uploading&&100===t.uploadStatus.progress}]},[t.uploadStatus.uploading||100===t.uploadStatus.progress?c("",!0):(d(),u("i",Zt)),t.uploadStatus.uploading&&100!==t.uploadStatus.progress?(d(),u("i",ea)):c("",!0),t.uploadStatus.uploading||100!==t.uploadStatus.progress?c("",!0):(d(),u("i",ta))],2),100===t.uploadStatus.progress||t.uploadStatus.uploading?c("",!0):(d(),u("div",{key:0,class:"remove-to-upload-image",onClick:a=>e.removeToUploadImage(t)},[v(p,{effect:"dark",content:"移除",placement:"top"},{default:T((()=>[aa])),_:1})],8,["onClick"]))],2)))),128))])])):c("",!0)])):c("",!0)};const na=(e,t,a=0)=>{if(!e)return;if(!Ut(e.type))return void U.error("该文件不是图片格式！");const s=new FileReader;s.readAsDataURL(e),s.onload=function(){const s=this.result;if(null===a||s.length<=a)return void sa(s,e,t);let n=new Image;n.src=s,n.onload=function(){sa(function(e,t,a){let s=document.createElement("canvas"),n=s.getContext("2d");const o=a,i=a/(e.width/e.height);s.width=o,s.height=i,n.fillStyle="#fff",n.fillRect(0,0,s.width,s.height),n.drawImage(e,0,0,o,i);const l=s.toDataURL(t,.75);return s=n=null,l}(n,e.type,a/1024),e,t),n=null}}};var oa=i({name:"upload-area",props:{imageLoading:{type:Boolean,default:!1}},setup(){const e=I(),t=g({uploadAreaActive:p((()=>e.getters.getUploadAreaActive)),uploadSettings:p((()=>e.getters.getUploadSettings)).value,toUploadImage:p((()=>e.getters.getToUploadImage)),onSelect(t){e.commit("CHANGE_UPLOAD_AREA_ACTIVE",!0);for(const e of t.target.files)na(e,((e,t)=>{this.getImage(e,t)}),this.uploadSettings.isSetMaxSize?1024*this.uploadSettings.compressSize:null)},onDrop(t){const a=t.dataTransfer.files[0];na(a,((e,t)=>{this.getImage(e,t)}),this.uploadSettings.isSetMaxSize?1024*this.uploadSettings.compressSize:null),e.commit("CHANGE_UPLOAD_AREA_ACTIVE",!0)},async onPaste(e){const{url:t,file:a}=await((e,t=204800)=>{if(e.clipboardData&&e.clipboardData.items)return new Promise((a=>{for(let s=0,n=e.clipboardData.items.length;s<n;s++){const n=e.clipboardData.items[s];if("file"===n.kind){const e=n.getAsFile();na(e,((e,t)=>{a({url:e,file:t})}),t)}}}))})(e,this.uploadSettings.isSetMaxSize?1024*this.uploadSettings.compressSize:null);this.getImage(t,a)},getImage(t,a){this.toUploadImage.list.length===this.toUploadImage.uploadedNumber&&this.toUploadImage.list.length>0&&this.toUploadImage.uploadedNumber>0&&(e.dispatch("TO_UPLOAD_IMAGE_CLEAN_LIST"),e.dispatch("TO_UPLOAD_IMAGE_CLEAN_UPLOADED_NUMBER"));const s={uuid:"",uploadStatus:{progress:0,uploading:!1},imgData:{base64Content:"",base64Url:""},fileInfo:{size:0,lastModified:0},filename:{name:"",hash:"",suffix:"",now:"",initName:"",newName:"xxx",isHashRename:!0,isRename:!1},externalLink:{github:"",cdn:"",markdown_gh:"",markdown_cdn:""}};s.imgData.base64Url=t,s.imgData.base64Content=t.split(",")[1];const{name:n,hash:o,suffix:i}=Dt(a.name);s.uuid=o,s.fileInfo.size=a.size,s.fileInfo.lastModified=a.lastModified,s.filename.name=n,s.filename.hash=o,s.filename.suffix=i,s.filename.now=`${n}.${o}.${i}`,s.filename.initName=n,e.dispatch("TO_UPLOAD_IMAGE_LIST_ADD",JSON.parse(JSON.stringify(s))),e.dispatch("TO_UPLOAD_IMAGE_SET_CURRENT",{uuid:o,base64Url:t})}});return o({},m(t))}});const ia=D();h("data-v-e422b292");const la={key:0,for:"uploader",class:"active-upload"},ra={key:1,class:"tips active-upload"},da=v("i",{class:"icon el-icon-upload active-upload"},null,-1),ua=v("div",{class:"text active-upload"},"拖拽、粘贴、或点击此处上传",-1);_();const ca=ia(((e,t,a,s,n,o)=>{const i=R("loading");return E((d(),u("div",{class:["upload-area active-upload",{focus:e.uploadAreaActive}],onDragover:t[2]||(t[2]=M((()=>{}),["prevent"])),onDrop:t[3]||(t[3]=M(((...t)=>e.onDrop&&e.onDrop(...t)),["stop","prevent"])),onPaste:t[4]||(t[4]=(...t)=>e.onPaste&&e.onPaste(...t)),"element-loading-text":"图片上传中...","element-loading-background":"rgba(0, 0, 0, 0.5)"},[e.uploadAreaActive?(d(),u("label",la)):c("",!0),v("input",{id:"uploader",type:"file",onChange:t[1]||(t[1]=(...t)=>e.onSelect&&e.onSelect(...t)),multiple:"multiple"},null,32),e.toUploadImage.curImgBase64Url?c("",!0):(d(),u("div",ra,[da,ua])),e.toUploadImage.curImgBase64Url?(d(),u("img",{key:2,class:"active-upload",src:e.toUploadImage.curImgBase64Url,alt:"Pictures to be uploaded"},null,8,["src"])):c("",!0)],34)),[[i,e.imageLoading]])}));oa.render=ca,oa.__scopeId="data-v-e422b292";var ga=i({name:"Upload",components:{ImageCard:ct,ToUploadImageCard:Nt,UploadArea:oa},setup(){const e=I(),t=f(),a=l(null),s=l(null),n=l(null),i=l(null),r=g({userConfigInfo:p((()=>e.getters.getUserConfigInfo)).value,logoutStatus:p((()=>e.getters.getUserLoggingStatus)),uploadedImageList:p((()=>e.getters.getUploadedImageList)),toUploadImage:p((()=>e.getters.getToUploadImage)),imageLoading:!1}),d=()=>{r.imageLoading=!1,e.dispatch("TO_UPLOAD_IMAGE_LOGOUT")};return S((()=>r.logoutStatus),((e,t)=>{e||d()})),o(o({},m(r)),{GitHubExternalLinkInput:a,CDNExternalLinkInput:s,toUploadImageCard_dom:n,uploadArea_dom:i,resetUploadInfo:d,uploadImage:()=>{const{token:a,selectedRepos:s,selectedDir:o}=r.userConfigInfo;return a?s?o?void(0!==r.toUploadImage.list.length?r.toUploadImage.list.length!==r.toUploadImage.uploadedNumber?(r.imageLoading=!0,n.value.uploadImage_all(r.userConfigInfo).then((t=>{switch(t){case kt.uploaded:case kt.allUploaded:r.imageLoading=!1,e.dispatch("TO_UPLOAD_IMAGE_CLEAN_URL");break;case kt.uploadFail:r.imageLoading=!1,e.dispatch("TO_UPLOAD_IMAGE_LIST_FAIL")}})).catch((e=>{console.error("upload error: ",e),r.imageLoading=!1}))):U.error("请选择要上传的图片！"):U.error("图片不能为空！")):(U.error("目录不能为空！"),void t.push("/config")):(U.error("请选择一个仓库！"),void t.push("/config")):(U.error("请先完成图床配置！"),void t.push("/config"))}})}});const pa=D();h("data-v-7b84039d");const ma={class:"upload-page-container"},fa={key:0,class:"upload-page-left page-container",style:{width:"30%"}},Ia={class:"uploaded-item"},ha={class:"row-item"},_a={class:"content-box"},Ca={class:"row-item"},va={class:"content-box"},La={class:"row-item"},Da={class:"content-box",style:{"text-align":"right"}},ba=b("重置 "),Ua=b("上传 ");_();const Sa=pa(((e,t,a,s,n,o)=>{const i=C("ImageCard"),l=C("UploadArea"),r=C("ToUploadImageCard"),g=C("el-button");return d(),u("div",ma,[e.uploadedImageList.length?(d(),u("div",fa,[(d(!0),u(k,null,A(e.uploadedImageList,(e=>(d(),u("div",Ia,[v(i,{"image-obj":e,"is-uploaded":!0},null,8,["image-obj"])])))),256))])):c("",!0),v("div",{class:"upload-page-right page-container",style:{width:e.uploadedImageList.length?"70%":"100%"}},[v("div",ha,[v("div",_a,[v(l,{"image-loading":e.imageLoading,ref:"uploadArea_dom"},null,8,["image-loading"])])]),v("div",Ca,[v("div",va,[v(r,{ref:"toUploadImageCard_dom","loading-all-image":e.imageLoading},null,8,["loading-all-image"])])]),v("div",La,[v("div",Da,[e.toUploadImage.list.length?(d(),u(g,{key:0,plain:"",size:"small",onClick:e.resetUploadInfo},{default:pa((()=>[ba])),_:1},8,["onClick"])):c("",!0),v(g,{type:"primary",plain:"",size:"small",onClick:e.uploadImage},{default:pa((()=>[Ua])),_:1},8,["onClick"])])])],4)])}));ga.render=Sa,ga.__scopeId="data-v-7b84039d";var ka=i({name:"Management",components:{ImageCard:ct,selectedInfoBar:Et},setup(){const e=I(),t=f(),a=g({userConfigInfo:p((()=>e.getters.getUserConfigInfo)).value,loggingStatus:p((()=>e.getters.getUserLoggingStatus)).value,dirImageList:p((()=>e.getters.getDirImageList)).value,currentDirImageList:[],loadingImageList:!1,initDirImageList(){if(!this.dirImageList.length)return void this.getReposContent();const e=this.userConfigInfo.selectedDir,t=this.dirImageList.find((t=>t.dir===e));t?t.imageList.length>0?this.currentDirImageList=t.imageList:this.getDirContent(e):this.isHasDir(e)&&this.getDirContent(e)},getReposContent(){var t,a;Be.get(`/repos/${null==(t=this.userConfigInfo)?void 0:t.owner}/${null==(a=this.userConfigInfo)?void 0:a.selectedRepos}/contents`,{headers:{"Content-Type":"application/json",Authorization:`token ${this.userConfigInfo.token}`}}).then((t=>{if(console.log("res: ",t),t&&200===t.status&&t.data.length>0){e.dispatch("DIR_IMAGE_LIST_ADD_DIR","/");for(const a of t.data)"dir"===a.type?e.dispatch("DIR_IMAGE_LIST_ADD_DIR",a.name):"file"===a.type&&Ut(Dt(a.name).suffix)&&e.dispatch("DIR_IMAGE_LIST_ADD_IMAGE",this.getImageObject(a,"/"));this.isHasDir(this.userConfigInfo.selectedDir)||(this.userConfigInfo.selectedDir="/"),this.dirChange(this.userConfigInfo.selectedDir)}}))},isHasDir(e){return this.userConfigInfo.dirList.some((t=>t.value===e))},getDirContent(t){var a,s;this.loadingImageList=!0;const n={dir:t,imageList:[]};Be.get(`/repos/${null==(a=this.userConfigInfo)?void 0:a.owner}/${null==(s=this.userConfigInfo)?void 0:s.selectedRepos}/contents/${t}`,{headers:{"Content-Type":"application/json",Authorization:`token ${this.userConfigInfo.token}`}}).then((a=>{if(a&&200===a.status&&a.data.length>0){const s=[];for(const e of a.data)"file"===e.type&&Ut(Dt(e.name).suffix)&&s.push(this.getImageObject(e,t));n.imageList=s,e.dispatch("DIR_IMAGE_LIST_ADD_IMAGE_LIST",n),this.loadingImageList=!1}}))},getImageObject(e,t){return{uuid:Lt(),dir:t,name:e.name,path:e.path,sha:e.sha,github_url:St(ot.gh,e,this.userConfigInfo),cdn_url:St(ot.cdn,e,this.userConfigInfo),md_gh_url:St(ot.md_gh,e,this.userConfigInfo),md_cdn_url:St(ot.md_cdn,e,this.userConfigInfo),deleting:!1,is_transform_md:!1}},dirChange(e){const t=this.dirImageList.find((t=>t.dir===e));t&&t.imageList.length?this.currentDirImageList=t.imageList:this.getDirContent(e)}});return r((()=>{a.initDirImageList()})),S((()=>a.loggingStatus),(e=>{!e&&t.push("/config")})),S((()=>a.dirImageList),(e=>{const t=e.find((e=>e.dir===a.userConfigInfo.selectedDir));t&&(a.currentDirImageList=t.imageList)}),{deep:!0}),o(o({},m(a)),{dirChange:function(e){a.dirChange(e)}})}});const Aa=D();h("data-v-1dd798c8");const Ea={class:"page-container management-page-container"},Oa={class:"content-container"},wa={class:"top"},ya={class:"left"},Ra={class:"right"},Ta=b(" 切换目录： "),Ma={class:"bottom","element-loading-text":"加载中...","element-loading-background":"rgba(0, 0, 0, 0.6)"},Pa={class:"image-list"},xa={class:"image-item",style:{width:"220px",height:"230px"}};_();const Ga=Aa(((e,t,a,s,n,o)=>{const i=C("selectedInfoBar"),l=C("el-option"),r=C("el-select"),c=C("ImageCard"),g=R("loading");return d(),u("div",Ea,[v("div",Oa,[v("div",wa,[v("div",ya,[v(i)]),v("div",Ra,[Ta,v(r,{modelValue:e.userConfigInfo.selectedDir,"onUpdate:modelValue":t[1]||(t[1]=t=>e.userConfigInfo.selectedDir=t),placeholder:"请选择",size:"mini",onChange:e.dirChange},{default:Aa((()=>[(d(!0),u(k,null,A(e.userConfigInfo.dirList,(e=>(d(),u(l,{label:e.label,value:e.value},null,8,["label","value"])))),256))])),_:1},8,["modelValue","onChange"])])]),E(v("div",Ma,[v("ul",Pa,[(d(!0),u(k,null,A(e.currentDirImageList,(e=>(d(),u("li",xa,[v(c,{"image-obj":e},null,8,["image-obj"])])))),256))])],512),[[g,e.loadingImageList]])])])}));ka.render=Ga,ka.__scopeId="data-v-1dd798c8";const Na={class:"tutorials-step-1"},Va=b(" 创建一个用来存储图片的 "),$a=v("img",{src:"https://cdn.jsdelivr.net/gh/XPoet/image-hosting@master/PicX/image.j1486dtk68n.png",alt:"Create GitHub Repository"},null,-1);var ja=i({expose:[],setup(e){function t(){window.open("https://github.com/new")}return(e,a)=>(d(),u("div",Na,[v("h3",null,[Va,v("span",{class:"go-create-repo",onClick:t}," GitHub 仓库")]),$a]))}});const za={class:"tutorials-step-2"},Fa=b(" 创建一个有 repo 权限的 "),Xa=v("img",{src:"https://cdn.jsdelivr.net/gh/XPoet/image-hosting@master/PicX/image.lpt1xl9fu.png",alt:"Create GitHub Token"},null,-1),Ba=v("p",null,"然后点击 Generate token 按钮，即可生成一个token，如下图：",-1),Ha=v("img",{src:"https://cdn.jsdelivr.net/gh/XPoet/image-hosting@master/PicX/image.pzmcp6b80fk.png",alt:"token-demo"},null,-1),Ya=v("p",{style:{color:"red"}},[v("em",null,"新生成的 Token 只会显示一次，请妥善保存！如有遗失，重新生成即可。")],-1);var Ja=i({expose:[],setup(e){function t(){window.open("https://github.com/settings/tokens/new")}return(e,a)=>(d(),u("div",za,[v("h3",null,[Fa,v("span",{class:"go-create-token",onClick:t}," GitHub Token")]),Xa,Ba,Ha,Ya]))}});const qa={},Wa={class:"tutorials-step-3"},Ka=P('<h3>进行图床配置（绑定 GitHub Token、存储图片的仓库和目录）</h3><p>1、填写 Token，自动获取该用户下的仓库</p><img src="https://cdn.jsdelivr.net/gh/XPoet/image-hosting@master/PicX/image.4g8q5m7c8sq0.png"><br><p>2、在仓库的下拉列表中，选择一个作为图床的仓库</p><img src="https://cdn.jsdelivr.net/gh/XPoet/image-hosting@master/PicX/image.746g75olruk0.png"><br><p>3、选择一种目录方式（目录即仓库里存放图片的文件夹）</p><img src="https://cdn.jsdelivr.net/gh/XPoet/image-hosting@master/PicX/image.5ydmhgxjhgo0.png"><div class="dir-desc-box"><ul><li>新建目录：需手动输入一个新目录。</li><li>根目录：图片将直接存储在仓库根目录下。</li><li>自动目录：自动生成日期格式 YYYYMMDD 的目录。例如：20200909</li><li>选择仓库目录：自动获取仓库下所有目录，选择一个即可。</li></ul></div>',10);qa.render=function(e,t){return d(),u("div",Wa,[Ka])};var Qa=i({name:"Tutorials",components:{Step1:ja,Step2:Ja,Step3:qa},setup(){const e=l(0);return{stepNum:e,step:t=>{"prev"===t&&(e.value<0?e.value=0:e.value--),"next"===t&&(e.value>3?e.value=3:e.value++)}}}});const Za=D();h("data-v-9831609a");const es={class:"page-container tutorials-page-container"},ts={class:"step-content"},as={key:3},ss=v("h2",null,"🌟 恭喜你完成图床使用教程 👍 快去试试吧~",-1),ns={class:"btn-next-prev"},os=b("上一步 "),is=b("下一步 ");_();const ls=Za(((e,t,a,s,n,o)=>{const i=C("el-step"),l=C("el-steps"),r=C("Step1"),g=C("Step2"),p=C("Step3"),m=C("el-button");return d(),u("div",es,[v(l,{active:e.stepNum,"finish-status":"success","align-center":""},{default:Za((()=>[v(i,{title:"创建 GitHub 仓库"}),v(i,{title:"获取 GitHub Token"}),v(i,{title:"配置图床"})])),_:1},8,["active"]),v("div",ts,[0===e.stepNum?(d(),u(r,{key:0})):c("",!0),1===e.stepNum?(d(),u(g,{key:1})):c("",!0),2===e.stepNum?(d(),u(p,{key:2})):c("",!0),3===e.stepNum?(d(),u("div",as,[ss])):c("",!0)]),v("div",ns,[e.stepNum>0?(d(),u(m,{key:0,type:"primary",onClick:t[1]||(t[1]=t=>e.step("prev"))},{default:Za((()=>[os])),_:1})):c("",!0),e.stepNum<3?(d(),u(m,{key:1,type:"primary",onClick:t[2]||(t[2]=t=>e.step("next"))},{default:Za((()=>[is])),_:1})):c("",!0)])])}));Qa.render=ls,Qa.__scopeId="data-v-9831609a";const rs=[{path:"/",name:"Index",redirect:{name:"Upload"}},{path:"/config",name:"Config",component:qe,meta:{title:"图床配置 | PicX 图床神器"}},{path:"/upload",name:"Upload",component:ga,meta:{title:"图片上传 | PicX 图床神器"}},{path:"/management",name:"Management",component:ka,meta:{title:"图床管理 | PicX 图床神器"}},{path:"/tutorials",name:"Tutorials",component:Qa,meta:{title:"使用教程 | PicX 图床神器"}},{path:"/about",name:"About",component:()=>function(e,t){if(!t)return e();if(void 0===Fe){const e=document.createElement("link").relList;Fe=e&&e.supports&&e.supports("modulepreload")?"modulepreload":"preload"}return Promise.all(t.map((e=>{if(e in Xe)return;Xe[e]=!0;const t=e.endsWith(".css"),a=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${a}`))return;const s=document.createElement("link");return s.rel=t?"stylesheet":Fe,t||(s.as="script",s.crossOrigin=""),s.href=e,document.head.appendChild(s),t?new Promise(((e,t)=>{s.addEventListener("load",e),s.addEventListener("error",t)})):void 0}))).then((()=>e()))}((()=>__import__("./index.56d77372.js")),["./assets/index.56d77372.js","./assets/index.3cb6b11c.css","./assets/vendor.cb341a13.js"]),meta:{title:"帮助反馈 | PicX 图床神器"}}],ds=x({history:G(),routes:rs});ds.beforeEach(((e,t,a)=>{e.meta.title&&(window.document.title=e.meta.title),a()}));const us=()=>{let e=sessionStorage.getItem("PICX_UPLOADED");return e?JSON.parse(e):[]};const cs=()=>{let e=localStorage.getItem("PICX_MANAGEMENT");return e?JSON.parse(e):[]};const gs=e=>{const t=Object.prototype.toString.call(e).split(" ")[1];return t.substring(0,t.length-1).toLowerCase()},ps=e=>{for(let t in e)switch(gs(e[t])){case"object":ps(e[t]);break;case"string":e[t]="";break;case"array":e[t]=[];break;case"number":e[t]=0;break;case"boolean":e[t]=!1}};var ms=N({modules:{toUploadImage:{state:()=>({curImgBase64Url:"",curImgUuid:"",list:[],uploadedNumber:0}),actions:{TO_UPLOAD_IMAGE_LIST_ADD(e,t){e.state.list.unshift(t)},TO_UPLOAD_IMAGE_SET_CURRENT(e,{uuid:t,base64Url:a}){e.state.curImgUuid=t,e.state.curImgBase64Url=a},TO_UPLOAD_IMAGE_UPLOADED(e,t){e.state.uploadedNumber++},TO_UPLOAD_IMAGE_LIST_REMOVE(e,t){if(e.state.list.length>0){const a=e.state.list.findIndex((e=>e.uuid===t));if(-1!==a&&e.state.list.splice(a,1),0===e.state.list.length)e.state.curImgBase64Url="",e.state.uploadedNumber=0;else if(e.state.curImgUuid===t){const t=e.state.list[0];e.state.curImgBase64Url=t.imgData.base64Url,e.state.curImgUuid=t.uuid}}},TO_UPLOAD_IMAGE_LIST_FAIL(e){if(e.state.list.length>0){const t=e.state.list.filter((e=>100!==e.uploadStatus.progress));t.length>0&&(e.state.list=t,e.state.uploadedNumber=0,e.state.curImgBase64Url=t[0].imgData.base64Url)}},TO_UPLOAD_IMAGE_CLEAN_URL(e){e.state.curImgBase64Url=""},TO_UPLOAD_IMAGE_CLEAN_LIST(e){e.state.list=[]},TO_UPLOAD_IMAGE_CLEAN_UPLOADED_NUMBER(e){e.state.uploadedNumber=0},TO_UPLOAD_IMAGE_LOGOUT(e){e.state.curImgBase64Url="",e.state.list=[],e.state.uploadedNumber=0}},getters:{getToUploadImageList:e=>e.list,getToUploadImage:e=>e}},uploadedImageList:{state:()=>({uploadedImageList:us()}),mutations:{},actions:{UPLOADED_LIST_ADD(e,t){e.state.uploadedImageList.unshift(t),e.dispatch("UPLOADED_LIST_PERSIST")},UPLOADED_LIST_REMOVE(e,t){if(e.state.uploadedImageList.length>0){const a=e.state.uploadedImageList.findIndex((e=>e.uuid===t.uuid));-1!==a&&(e.state.uploadedImageList.splice(a,1),e.dispatch("UPLOADED_LIST_PERSIST"))}},UPLOADED_LIST_PERSIST(e){sessionStorage.setItem("PICX_UPLOADED",JSON.stringify(e.state.uploadedImageList))},UPLOADED_LIST_LOGOUT(e){e.state.uploadedImageList=[],sessionStorage.removeItem("PICX_UPLOADED")}},getters:{getUploadedImageList:e=>e.uploadedImageList}},dirImageList:{state:()=>({dirImageList:cs()}),mutations:{},actions:{DIR_IMAGE_LIST_ADD_IMAGE(e,t){const a=e.state.dirImageList.find((e=>e.dir===t.dir));a&&(a.imageList.push(t),e.dispatch("DIR_IMAGE_LIST_PERSIST"))},DIR_IMAGE_LIST_ADD_IMAGE_LIST(e,t){const a=e.state.dirImageList.find((e=>e.dir===t.dir));a?a.imageList=t.imageList:e.state.dirImageList.unshift(t),e.dispatch("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_ADD_DIR(e,t){if(!e.state.dirImageList.some((e=>e.dir===t))){const a={dir:t,imageList:[]};"/"===t?e.state.dirImageList.unshift(a):e.state.dirImageList.push(a),e.dispatch("DIR_IMAGE_LIST_PERSIST")}},DIR_IMAGE_LIST_REMOVE_DIR(e,t){if(e.state.dirImageList.some((e=>e.dir===t))){const a=e.state.dirImageList.findIndex((e=>e.dir===t));e.state.dirImageList.splice(a,1),e.dispatch("DIR_IMAGE_LIST_PERSIST")}},DIR_IMAGE_LIST_REMOVE(e,t){if(e.state.dirImageList.length>0){const a=e.state.dirImageList.find((e=>e.dir===t.dir));if(a){const s=a.imageList.findIndex((e=>e.uuid===t.uuid));-1!==s&&(a.imageList.splice(s,1),0===a.imageList.length&&(e.dispatch("DIR_IMAGE_LIST_REMOVE_DIR",a.dir),e.dispatch("USER_CONFIG_INFO_REMOVE_DIR",a.dir)),e.dispatch("DIR_IMAGE_LIST_PERSIST"))}}},DIR_IMAGE_LIST_PERSIST(e){localStorage.setItem("PICX_MANAGEMENT",JSON.stringify(e.state.dirImageList))},DIR_IMAGE_LOGOUT(e){e.state.dirImageList=[],localStorage.removeItem("PICX_MANAGEMENT")}},getters:{getDirImageList:e=>e.dirImageList}},userConfigInfo:{state:()=>(()=>{let e=localStorage.getItem("PICX_CONFIG");return e?JSON.parse(e):{token:"",owner:"",email:"",name:"",avatarUrl:"",selectedRepos:"",reposList:[],selectedBranch:"",dirMode:"",selectedDir:"",dirList:[],loggingStatus:!1}})(),actions:{SET_USER_CONFIG_INFO(e,t){for(const a in t)e.state.hasOwnProperty(a)&&(e.state[a]=t[a])},USER_CONFIG_INFO_ADD_DIR(e,t){e.state.dirList.some((e=>e.value===t))||(e.state.dirList.push({label:t,value:t}),e.dispatch("USER_CONFIG_INFO_PERSIST"))},USER_CONFIG_INFO_REMOVE_DIR(e,t){const a=e.state.dirList;if(a.some((e=>e.value===t))){const s=a.findIndex((e=>e.value===t));a.splice(s,1),e.dispatch("USER_CONFIG_INFO_PERSIST")}},USER_CONFIG_INFO_PERSIST(e){e.state.selectedDir=e.state.selectedDir.replace(/\s+/g,"-"),localStorage.setItem("PICX_CONFIG",JSON.stringify(e.state))},USER_CONFIG_INFO_LOGOUT(e){ps(e.state),localStorage.removeItem("PICX_CONFIG")}},getters:{getUserLoggingStatus:e=>e.loggingStatus,getUserConfigInfo:e=>e}}},state:()=>({imageViewer:{url:"",isShow:!1},uploadAreaActive:!1,uploadSettings:{isSetMaxSize:!1,compressSize:200}}),mutations:{IMAGE_VIEWER(e,{url:t,isShow:a}){e.imageViewer.url=t,e.imageViewer.isShow=a},CHANGE_UPLOAD_AREA_ACTIVE(e,t){e.uploadAreaActive=t}},actions:{LOGOUT({state:e,dispatch:t}){e.uploadAreaActive=!1,e.imageViewer.isShow=!1,e.imageViewer.url="",t("DIR_IMAGE_LOGOUT"),t("TO_UPLOAD_IMAGE_LOGOUT"),t("UPLOADED_LIST_LOGOUT"),t("USER_CONFIG_INFO_LOGOUT")}},getters:{getImageViewer:e=>e.imageViewer,getUploadAreaActive:e=>e.uploadAreaActive,getUploadSettings:e=>e.uploadSettings}});V(ze).use(ds).use(ms).use($).use(j).use(z).use(F).use(X).use(B).use(H).use(Y).use(J).use(q).use(W).use(K).use(Q).use(Z).use(ee).use(te).use(ae).use(se).use(ne).use(oe).mount("#app");
